2025-08-06 08:34:38.973 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 08:34:39.051 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 08:34:39.062 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 08:34:39.321 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 08:34:39.336 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 08:34:39.407 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 08:34:39.407 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 08:34:39.407 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_yyjyyyg93sneyczhbdq7jye8yz"
2025-08-06 08:34:39.407 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 08:34:39.417 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 08:34:51.024 +08:00 [INF] HTTP POST /user/user-login responded 200 in 2087.4311 ms
2025-08-06 08:35:00.040 +08:00 [INF] HTTP POST /user/user-login responded 200 in 40.4464 ms
2025-08-06 08:35:07.587 +08:00 [INF] HTTP POST /user/user-login responded 200 in 20.2688 ms
2025-08-06 08:35:09.268 +08:00 [INF] HTTP POST /user/user-login responded 200 in 4.0446 ms
2025-08-06 08:35:10.531 +08:00 [INF] HTTP POST /user/user-login responded 200 in 3.7062 ms
2025-08-06 08:35:11.378 +08:00 [INF] HTTP POST /user/user-login responded 200 in 4.2218 ms
2025-08-06 08:35:11.700 +08:00 [INF] HTTP POST /user/user-login responded 200 in 4.5085 ms
2025-08-06 08:35:11.923 +08:00 [INF] HTTP POST /user/user-login responded 200 in 3.6353 ms
2025-08-06 08:35:12.206 +08:00 [INF] HTTP POST /user/user-login responded 200 in 4.1748 ms
2025-08-06 08:35:12.365 +08:00 [INF] HTTP POST /user/user-login responded 200 in 4.2485 ms
2025-08-06 08:35:12.590 +08:00 [INF] HTTP POST /user/user-login responded 200 in 3.9951 ms
2025-08-06 08:35:12.888 +08:00 [INF] HTTP POST /user/user-login responded 200 in 4.0004 ms
2025-08-06 08:35:13.125 +08:00 [INF] HTTP POST /user/user-login responded 200 in 3.5051 ms
2025-08-06 08:35:13.281 +08:00 [INF] HTTP POST /user/user-login responded 200 in 3.9650 ms
2025-08-06 08:35:13.483 +08:00 [INF] HTTP POST /user/user-login responded 200 in 3.6745 ms
2025-08-06 08:35:13.769 +08:00 [INF] HTTP POST /user/user-login responded 200 in 4.7406 ms
2025-08-06 08:35:14.104 +08:00 [INF] HTTP POST /user/user-login responded 200 in 4.0675 ms
2025-08-06 08:35:14.315 +08:00 [INF] HTTP POST /user/user-login responded 200 in 3.6473 ms
2025-08-06 08:35:14.542 +08:00 [INF] HTTP POST /user/user-login responded 200 in 5.4389 ms
2025-08-06 08:35:14.762 +08:00 [INF] HTTP POST /user/user-login responded 200 in 4.0318 ms
2025-08-06 08:35:14.999 +08:00 [INF] HTTP POST /user/user-login responded 200 in 6.4065 ms
2025-08-06 08:35:15.361 +08:00 [INF] HTTP POST /user/user-login responded 200 in 4.5379 ms
2025-08-06 08:36:00.689 +08:00 [DBG] Stopping bus instances: IBus
2025-08-06 08:36:00.704 +08:00 [DBG] Stopping bus: "loopback://localhost/"
2025-08-06 08:36:00.721 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 08:36:00.728 +08:00 [DBG] Consumer Stopping: "loopback://localhost/WcsIntegrationEvent" (Stop Receive Transport)
2025-08-06 08:36:00.755 +08:00 [DBG] Endpoint Completed: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 08:36:00.784 +08:00 [DBG] Consumer Completed: "loopback://localhost/WcsIntegrationEvent": 0 received, 0 concurrent
2025-08-06 08:36:00.795 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 08:36:00.800 +08:00 [DBG] Consumer Stopping: "loopback://localhost/S7ReadPlcDataBlockEvent" (Stop Receive Transport)
2025-08-06 08:36:00.806 +08:00 [DBG] Endpoint Completed: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 08:36:00.810 +08:00 [DBG] Consumer Completed: "loopback://localhost/S7ReadPlcDataBlockEvent": 0 received, 0 concurrent
2025-08-06 08:36:00.815 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 08:36:00.818 +08:00 [DBG] Consumer Stopping: "loopback://localhost/S7WritePlcDataBlockEvent" (Stop Receive Transport)
2025-08-06 08:36:00.821 +08:00 [DBG] Endpoint Completed: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 08:36:00.822 +08:00 [DBG] Consumer Completed: "loopback://localhost/S7WritePlcDataBlockEvent": 0 received, 0 concurrent
2025-08-06 08:36:00.830 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/_WarehourceSource_bus_yyjyyyg93sneyczhbdq7jye8yz"
2025-08-06 08:36:00.832 +08:00 [DBG] Consumer Stopping: "loopback://localhost/_WarehourceSource_bus_yyjyyyg93sneyczhbdq7jye8yz" (Stop Receive Transport)
2025-08-06 08:36:00.833 +08:00 [DBG] Endpoint Completed: "loopback://localhost/_WarehourceSource_bus_yyjyyyg93sneyczhbdq7jye8yz"
2025-08-06 08:36:00.835 +08:00 [DBG] Consumer Completed: "loopback://localhost/_WarehourceSource_bus_yyjyyyg93sneyczhbdq7jye8yz": 0 received, 0 concurrent
2025-08-06 08:36:00.865 +08:00 [INF] Bus stopped: "loopback://localhost/"
2025-08-06 08:36:55.174 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 08:36:55.292 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 08:36:55.301 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 08:36:55.592 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 08:36:55.601 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 08:36:55.681 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_9ypoyyg93snebxtabdq7jykanq"
2025-08-06 08:36:55.681 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 08:36:55.681 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 08:36:55.681 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 08:36:55.690 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 08:37:11.532 +08:00 [INF] HTTP POST /user/user-login responded 200 in 793.2733 ms
2025-08-06 08:37:31.532 +08:00 [INF] HTTP GET /user/get-roles responded 200 in 217.1098 ms
2025-08-06 08:37:42.399 +08:00 [INF] HTTP GET /plc/get-allplc responded 200 in 60.2344 ms
2025-08-06 08:37:50.753 +08:00 [DBG] Stopping bus instances: IBus
2025-08-06 08:37:50.765 +08:00 [DBG] Stopping bus: "loopback://localhost/"
2025-08-06 08:37:50.788 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 08:37:50.795 +08:00 [DBG] Consumer Stopping: "loopback://localhost/WcsIntegrationEvent" (Stop Receive Transport)
2025-08-06 08:37:50.828 +08:00 [DBG] Endpoint Completed: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 08:37:50.865 +08:00 [DBG] Consumer Completed: "loopback://localhost/WcsIntegrationEvent": 0 received, 0 concurrent
2025-08-06 08:37:50.876 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 08:37:50.879 +08:00 [DBG] Consumer Stopping: "loopback://localhost/S7ReadPlcDataBlockEvent" (Stop Receive Transport)
2025-08-06 08:37:50.883 +08:00 [DBG] Endpoint Completed: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 08:37:50.886 +08:00 [DBG] Consumer Completed: "loopback://localhost/S7ReadPlcDataBlockEvent": 0 received, 0 concurrent
2025-08-06 08:37:50.892 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 08:37:50.895 +08:00 [DBG] Consumer Stopping: "loopback://localhost/S7WritePlcDataBlockEvent" (Stop Receive Transport)
2025-08-06 08:37:50.900 +08:00 [DBG] Endpoint Completed: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 08:37:50.904 +08:00 [DBG] Consumer Completed: "loopback://localhost/S7WritePlcDataBlockEvent": 0 received, 0 concurrent
2025-08-06 08:37:50.908 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/_WarehourceSource_bus_9ypoyyg93snebxtabdq7jykanq"
2025-08-06 08:37:50.911 +08:00 [DBG] Consumer Stopping: "loopback://localhost/_WarehourceSource_bus_9ypoyyg93snebxtabdq7jykanq" (Stop Receive Transport)
2025-08-06 08:37:50.914 +08:00 [DBG] Endpoint Completed: "loopback://localhost/_WarehourceSource_bus_9ypoyyg93snebxtabdq7jykanq"
2025-08-06 08:37:50.916 +08:00 [DBG] Consumer Completed: "loopback://localhost/_WarehourceSource_bus_9ypoyyg93snebxtabdq7jykanq": 0 received, 0 concurrent
2025-08-06 08:37:50.961 +08:00 [INF] Bus stopped: "loopback://localhost/"
2025-08-06 08:57:07.759 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 08:57:07.841 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 08:57:07.849 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 08:57:08.406 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 08:57:08.427 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 08:57:08.629 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_iohoyyg93snebujybdq7jbbmbk"
2025-08-06 08:57:08.629 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 08:57:08.629 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 08:57:08.629 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 08:57:08.641 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 08:57:56.636 +08:00 [INF] HTTP GET /plc/get-allplc responded 200 in 994.3407 ms
2025-08-06 08:59:45.225 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 08:59:45.395 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 08:59:45.413 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 08:59:46.574 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 08:59:46.598 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 08:59:46.835 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 08:59:46.835 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_cb6yyyg93snebtnobdq7jbrjn7"
2025-08-06 08:59:46.835 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 08:59:46.835 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 08:59:46.845 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 08:59:59.065 +08:00 [INF] HTTP POST /user/user-login responded 200 in 2293.0035 ms
2025-08-06 09:18:12.952 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 09:18:13.163 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 09:18:13.180 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 09:18:14.299 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 09:18:14.320 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 09:18:14.598 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 09:18:14.598 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 09:18:14.598 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 09:18:14.598 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_jtnoyyg93sney1c5bdq7jba7rm"
2025-08-06 09:18:14.616 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 09:18:28.088 +08:00 [INF] HTTP POST /user/user-login responded 200 in 5050.5277 ms
2025-08-06 09:20:41.185 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 09:20:41.387 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 09:20:41.408 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 09:20:42.440 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 09:20:42.462 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 09:20:42.729 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 09:20:42.729 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 09:20:42.729 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 09:20:42.729 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_pbgoyyg93sneyx69bdq7jb5i8m"
2025-08-06 09:20:42.742 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 09:21:30.165 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 09:21:30.335 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 09:21:30.356 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 09:21:31.408 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 09:21:31.432 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 09:21:31.733 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 09:21:31.733 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 09:21:31.734 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 09:21:31.734 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_qbuyyyg93sneygd8bdq7jbhuys"
2025-08-06 09:21:31.748 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 09:21:42.397 +08:00 [INF] HTTP POST /user/user-login responded 200 in 1542.5731 ms
2025-08-06 09:29:02.257 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 09:29:02.452 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 09:29:02.470 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 09:29:03.434 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 09:29:03.452 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 09:29:03.688 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 09:29:03.690 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 09:29:03.688 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 09:29:03.690 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_fouyyyg93snebmrgbdq7jnfyru"
2025-08-06 09:29:03.716 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 09:29:11.891 +08:00 [INF] HTTP GET /user/get-roles responded 401 in 337.8876 ms
2025-08-06 09:29:27.521 +08:00 [INF] HTTP GET /get/get-users responded 401 in 20.5335 ms
2025-08-06 09:30:34.796 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 09:30:35.018 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 09:30:35.038 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 09:30:36.192 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 09:30:36.224 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 09:30:36.507 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 09:30:36.510 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 09:30:36.510 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_zyeyyyg93snebfbibdq7jngzgr"
2025-08-06 09:30:36.510 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 09:30:36.536 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 09:30:46.788 +08:00 [INF] HTTP POST /user/user-login responded 200 in 1449.4853 ms
2025-08-06 09:30:55.879 +08:00 [INF] HTTP GET /user/get-roles responded 401 in 54.9158 ms
2025-08-06 13:18:25.181 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 13:18:25.219 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 13:18:25.225 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 13:18:25.461 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 13:18:25.465 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 13:18:25.541 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_zokoyynqz1igydhobdq7jkfmry"
2025-08-06 13:18:25.541 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 13:18:25.541 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 13:18:25.541 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 13:18:25.544 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 13:18:37.560 +08:00 [INF] HTTP POST /user/user-login responded 200 in 2108.2678 ms
2025-08-06 13:19:00.597 +08:00 [INF] HTTP POST /user/user-login responded 200 in 80.3344 ms
2025-08-06 13:19:15.523 +08:00 [INF] HTTP GET /user/get-roles responded 401 in 11.2468 ms
2025-08-06 13:19:37.767 +08:00 [INF] HTTP GET /user/get-roles responded 200 in 421.6142 ms
2025-08-06 13:19:53.640 +08:00 [INF] HTTP GET /get/get-users responded 200 in 342.9299 ms
2025-08-06 13:20:03.290 +08:00 [INF] HTTP DELETE /user/Delete-role/{roleName} responded 200 in 11.1643 ms
2025-08-06 13:20:25.286 +08:00 [ERR] HTTP POST /user/add-user responded 500 in 797.5803 ms
2025-08-06 13:23:02.413 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 13:23:02.469 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 13:23:02.475 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 13:23:02.742 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 13:23:02.747 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 13:23:02.834 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 13:23:02.834 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 13:23:02.834 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 13:23:02.834 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_tbsyyynqz1igbbqmbdq7jkkoge"
2025-08-06 13:23:02.839 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 13:23:20.454 +08:00 [INF] HTTP POST /user/add-user responded 200 in 861.0330 ms
2025-08-06 13:23:33.342 +08:00 [INF] HTTP POST /job/job-status responded 200 in 336.4032 ms
2025-08-06 13:23:41.691 +08:00 [INF] HTTP GET /job/get-jobs responded 200 in 477.0782 ms
2025-08-06 13:23:49.911 +08:00 [INF] HTTP POST /job/add-job responded 200 in 436.9101 ms
2025-08-06 13:24:05.208 +08:00 [INF] HTTP POST /job/delete-job responded 200 in 261.5937 ms
2025-08-06 13:24:15.271 +08:00 [INF] HTTP GET /plc/get-allplc responded 200 in 366.9679 ms
2025-08-06 13:26:00.336 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 13:26:00.391 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 13:26:00.394 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 13:26:00.604 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 13:26:00.609 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 13:26:00.676 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 13:26:00.676 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 13:26:00.676 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_jb7oyynqz1igbtskbdq7jkp4gx"
2025-08-06 13:26:00.676 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 13:26:00.681 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 13:26:11.902 +08:00 [INF] HTTP GET /user/get-roles responded 200 in 577.1879 ms
2025-08-06 13:26:23.088 +08:00 [ERR] HTTP POST /wcstask/add-or-update-wcstask responded 500 in 2671.0654 ms
2025-08-06 13:27:10.888 +08:00 [ERR] HTTP POST /wcstask/add-or-update-wcstask responded 500 in 14739.5880 ms
2025-08-06 13:28:56.577 +08:00 [ERR] HTTP POST /wcstask/add-or-update-wcstask responded 500 in 29029.6555 ms
2025-08-06 13:31:18.862 +08:00 [ERR] HTTP POST /wcstask/add-or-update-wcstask responded 500 in 87388.2147 ms
2025-08-06 13:34:16.677 +08:00 [ERR] HTTP POST /wcstask/add-or-update-wcstask responded 500 in 99651.5172 ms
2025-08-06 13:37:27.022 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 13:37:27.060 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 13:37:27.065 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 13:37:27.286 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 13:37:27.293 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 13:37:27.354 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_hbxoyynqz1igb1d8bdq7jk4wy3"
2025-08-06 13:37:27.354 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 13:37:27.354 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 13:37:27.354 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 13:37:27.357 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 13:37:46.456 +08:00 [ERR] HTTP POST /wcstask/add-or-update-wcstask responded 500 in 3965.6296 ms
2025-08-06 13:38:38.670 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:38:43.175 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Wcs.__EFMigrationsHistory]');
2025-08-06 13:38:43.179 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:38:43.182 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Wcs.__EFMigrationsHistory]');
2025-08-06 13:38:43.193 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Wcs.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 13:38:43.203 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 13:38:43.227 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:38:43.231 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Identity.__EFMigrationsHistory]');
2025-08-06 13:38:43.233 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:38:43.236 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Identity.__EFMigrationsHistory]');
2025-08-06 13:38:43.242 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Identity.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 13:38:43.244 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 13:38:43.322 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:38:43.325 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Plc.__EFMigrationsHistory]');
2025-08-06 13:38:43.327 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:38:43.329 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Plc.__EFMigrationsHistory]');
2025-08-06 13:38:43.335 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Plc.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 13:38:43.344 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 13:38:43.628 +08:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[CreationTime], [w].[Description], [w].[IsDeleted], [w].[IsStart], [w].[JobType], [w].[LastModificationTime], [w].[LastModifierUser], [w].[Name], [w].[TimeOut], [w].[Timer]
FROM [Wcs.JobConfig] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-06 13:38:43.716 +08:00 [INF] User profile is available. Using 'C:\Users\吴\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-06 13:38:43.769 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 13:38:43.773 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 13:38:43.778 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 13:38:43.965 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 13:38:43.970 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 13:38:44.036 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 13:38:44.036 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_sb5oyynqz1igym1dbdq7jkhbg1"
2025-08-06 13:38:44.036 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 13:38:44.036 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 13:38:44.038 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 13:38:44.127 +08:00 [INF] Now listening on: http://localhost:5050
2025-08-06 13:38:44.132 +08:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-06 13:38:44.317 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-06 13:38:44.318 +08:00 [INF] Hosting environment: Development
2025-08-06 13:38:44.320 +08:00 [INF] Content root path: D:\Program\仓库\Warehource.Modules\Warehource.Source
2025-08-06 13:38:44.532 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/index.html - null null
2025-08-06 13:38:44.772 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/index.html - 200 null text/html;charset=utf-8 248.9792ms
2025-08-06 13:38:44.932 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_vs/browserLink - null null
2025-08-06 13:38:44.932 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - null null
2025-08-06 13:38:44.952 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 19.7418ms
2025-08-06 13:38:44.971 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_vs/browserLink - 200 null text/javascript; charset=UTF-8 39.3893ms
2025-08-06 13:38:45.022 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - null null
2025-08-06 13:38:45.075 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 53.3963ms
2025-08-06 13:38:45.259 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - null null
2025-08-06 13:38:45.264 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 4.75ms
2025-08-06 13:38:45.461 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - null null
2025-08-06 13:38:45.481 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 20.5504ms
2025-08-06 13:38:46.640 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - null null
2025-08-06 13:38:46.644 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 3.9652ms
2025-08-06 13:38:46.900 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - null null
2025-08-06 13:38:46.916 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 16.0007ms
2025-08-06 13:38:54.808 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5050/wcstask/add-or-update-wcstask - application/json 319
2025-08-06 13:38:54.817 +08:00 [INF] CORS policy execution successful.
2025-08-06 13:38:54.837 +08:00 [WRN] Failed to determine the https port for redirect.
2025-08-06 13:38:54.899 +08:00 [INF] Executing endpoint 'HTTP: POST wcstask/add-or-update-wcstask'
2025-08-06 13:38:58.615 +08:00 [INF] Executed DbCommand (19ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Wcs.WcsTask] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__id_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-06 13:38:58.884 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 50), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int32), @p4='?' (Size = 4000), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 50), @p10='?' (DbType = Guid), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32), @p13='?' (Size = 10), @p14='?' (Size = 10), @p15='?' (Size = 10), @p16='?' (Size = 10), @p17='?' (Size = 10), @p18='?' (Size = 10), @p19='?' (Size = 10), @p20='?' (Size = 10), @p21='?' (Size = 10), @p22='?' (Size = 10), @p23='?' (DbType = Guid), @p24='?' (DbType = DateTime2), @p25='?' (Size = 50), @p26='?' (DbType = Guid), @p27='?' (DbType = Boolean), @p28='?' (DbType = Boolean), @p29='?' (DbType = DateTime2), @p30='?' (Size = 4000), @p31='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Wcs.WcsTask] ([Id], [Container], [CreationTime], [CreatorSystemType], [Description], [IsDeleted], [LastModificationTime], [LastModifierUser], [RegionId], [TaskCode], [TaskExecuteStepId], [TaskStatus], [TaskType], [GetLocation_GetColumn], [GetLocation_GetDepth], [GetLocation_GetFloor], [GetLocation_GetRow], [GetLocation_GetTunnel], [PutLocation_PutColumn], [PutLocation_PutDepth], [PutLocation_PutFloor], [PutLocation_PutRow], [PutLocation_PutTunnel])
OUTPUT INSERTED.[SerialNumber], INSERTED.[Version]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
INSERT INTO [Wcs.TaskExecuteStep] ([Id], [CreationTime], [Description], [ExecuteNodePath], [IsDeleted], [IsSend], [LastModificationTime], [LastModifierUser], [PathNodeGroup])
OUTPUT INSERTED.[Version]
VALUES (@p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31);
2025-08-06 13:38:59.210 +08:00 [ERR] An exception occurred in the database while saving changes for context type 'Wcs.Infrastructure.Database.WCSDBContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): INSERT 语句与 FOREIGN KEY 约束"FK_Wcs.WcsTask_Wcs.TaskExecuteStep_TaskExecuteStepId"冲突。该冲突发生于数据库"Wcs.Source"，表"dbo.Wcs.TaskExecuteStep", column 'Id'。
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:6052b18c-722e-4d47-91a9-383c745ea589
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): INSERT 语句与 FOREIGN KEY 约束"FK_Wcs.WcsTask_Wcs.TaskExecuteStep_TaskExecuteStepId"冲突。该冲突发生于数据库"Wcs.Source"，表"dbo.Wcs.TaskExecuteStep", column 'Id'。
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:6052b18c-722e-4d47-91a9-383c745ea589
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-06 13:38:59.489 +08:00 [INF] Executed endpoint 'HTTP: POST wcstask/add-or-update-wcstask'
2025-08-06 13:38:59.658 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): INSERT 语句与 FOREIGN KEY 约束"FK_Wcs.WcsTask_Wcs.TaskExecuteStep_TaskExecuteStepId"冲突。该冲突发生于数据库"Wcs.Source"，表"dbo.Wcs.TaskExecuteStep", column 'Id'。
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:6052b18c-722e-4d47-91a9-383c745ea589
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Common.Infrastructure.EF.BaseDbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) in D:\Program\仓库\Warehource.Modules\Common.Infrastructure\EF\BaseDbContext.cs:line 26
   at Wcs.Application.DBHandler.WcsTask.Insert.AddOrUpdateWcsTaskHandler.Handle(AddOrUpdateWcsTaskEvent request, CancellationToken cancellationToken) in D:\Program\仓库\Warehource.Modules\Wcs.Application\DBHandler\WcsTask\AddOrUpdate\AddOrUpdateWcsTaskHandler.cs:line 71
   at Common.Application.MediatR.Behaviors.ValidationPipelineBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\Program\仓库\Warehource.Modules\Common.Application\MediatR\Behaviors\ValidationPipelineBehavior.cs:line 20
   at Wcs.Presentation.WcsTask.AddOrUpdateWcsTask.<>c.<<MapEndpoint>b__0_0>d.MoveNext() in D:\Program\仓库\Warehource.Modules\Wcs.Presentation\WcsTask\AddOrUpdateWcsTask.cs:line 25
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.<ExecuteTaskOfT>g__ExecuteAwaited|133_0[T](Task`1 task, HttpContext httpContext, JsonTypeInfo`1 jsonTypeInfo)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.<>c__DisplayClass102_2.<<HandleRequestBodyAndCompileRequestDelegateForJson>b__2>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-06 13:38:59.826 +08:00 [ERR] HTTP POST /wcstask/add-or-update-wcstask responded 500 in 4984.3251 ms
2025-08-06 13:38:59.950 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5050/wcstask/add-or-update-wcstask - 500 null application/json; charset=utf-8 5141.5965ms
2025-08-06 13:44:03.739 +08:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:44:03.802 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Wcs.__EFMigrationsHistory]');
2025-08-06 13:44:03.809 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:44:03.821 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Wcs.__EFMigrationsHistory]');
2025-08-06 13:44:03.835 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Wcs.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 13:44:03.849 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 13:44:03.878 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:44:03.887 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Identity.__EFMigrationsHistory]');
2025-08-06 13:44:03.891 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:44:03.894 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Identity.__EFMigrationsHistory]');
2025-08-06 13:44:03.900 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Identity.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 13:44:03.906 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 13:44:03.992 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:44:04.018 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Plc.__EFMigrationsHistory]');
2025-08-06 13:44:04.031 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:44:04.044 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Plc.__EFMigrationsHistory]');
2025-08-06 13:44:04.054 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Plc.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 13:44:04.066 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 13:44:04.372 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[CreationTime], [w].[Description], [w].[IsDeleted], [w].[IsStart], [w].[JobType], [w].[LastModificationTime], [w].[LastModifierUser], [w].[Name], [w].[TimeOut], [w].[Timer]
FROM [Wcs.JobConfig] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-06 13:44:04.468 +08:00 [INF] User profile is available. Using 'C:\Users\吴\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-06 13:44:04.536 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 13:44:04.540 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 13:44:04.549 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 13:44:04.797 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 13:44:04.802 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 13:44:04.883 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 13:44:04.883 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 13:44:04.883 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_wbayyynqz1igbd4xbdq7jmnby8"
2025-08-06 13:44:04.883 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 13:44:04.888 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 13:44:04.994 +08:00 [INF] Now listening on: http://localhost:5050
2025-08-06 13:44:05.003 +08:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-06 13:44:05.368 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-06 13:44:05.371 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/index.html - null null
2025-08-06 13:44:05.406 +08:00 [INF] Hosting environment: Development
2025-08-06 13:44:05.426 +08:00 [INF] Content root path: D:\Program\仓库\Warehource.Modules\Warehource.Source
2025-08-06 13:44:05.776 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/index.html - 200 null text/html;charset=utf-8 422.2939ms
2025-08-06 13:44:05.802 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - null null
2025-08-06 13:44:05.810 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 7.861ms
2025-08-06 13:44:05.926 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - null null
2025-08-06 13:44:05.934 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 8.0805ms
2025-08-06 13:44:05.974 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_vs/browserLink - null null
2025-08-06 13:44:05.988 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - null null
2025-08-06 13:44:05.998 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 9.7737ms
2025-08-06 13:44:06.021 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_vs/browserLink - 200 null text/javascript; charset=UTF-8 47.403ms
2025-08-06 13:44:06.083 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - null null
2025-08-06 13:44:06.109 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 26.3046ms
2025-08-06 13:44:06.979 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - null null
2025-08-06 13:44:06.999 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 20.2545ms
2025-08-06 13:44:07.099 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - null null
2025-08-06 13:44:07.113 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 14.0536ms
2025-08-06 13:49:49.515 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5050/wcstask/add-or-update-wcstask - application/json 319
2025-08-06 13:49:49.538 +08:00 [INF] CORS policy execution successful.
2025-08-06 13:49:49.559 +08:00 [WRN] Failed to determine the https port for redirect.
2025-08-06 13:49:49.701 +08:00 [INF] Executing endpoint 'HTTP: POST wcstask/add-or-update-wcstask'
2025-08-06 13:49:50.052 +08:00 [INF] Executed DbCommand (20ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Wcs.WcsTask] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__id_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-06 13:51:35.775 +08:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:51:35.844 +08:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Wcs.__EFMigrationsHistory]');
2025-08-06 13:51:35.848 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:51:35.852 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Wcs.__EFMigrationsHistory]');
2025-08-06 13:51:35.865 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Wcs.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 13:51:35.878 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 13:51:35.904 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:51:35.911 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Identity.__EFMigrationsHistory]');
2025-08-06 13:51:35.914 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:51:35.917 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Identity.__EFMigrationsHistory]');
2025-08-06 13:51:35.921 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Identity.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 13:51:35.925 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 13:51:36.009 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:51:36.013 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Plc.__EFMigrationsHistory]');
2025-08-06 13:51:36.016 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:51:36.019 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Plc.__EFMigrationsHistory]');
2025-08-06 13:51:36.024 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Plc.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 13:51:36.032 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 13:51:36.327 +08:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[CreationTime], [w].[Description], [w].[IsDeleted], [w].[IsStart], [w].[JobType], [w].[LastModificationTime], [w].[LastModifierUser], [w].[Name], [w].[TimeOut], [w].[Timer]
FROM [Wcs.JobConfig] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-06 13:51:36.422 +08:00 [INF] User profile is available. Using 'C:\Users\吴\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-06 13:51:36.485 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 13:51:36.490 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 13:51:36.497 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 13:51:36.704 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 13:51:36.708 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 13:51:36.781 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_db3oyynqz1igbme3bdq7jmkqdg"
2025-08-06 13:51:36.781 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 13:51:36.781 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 13:51:36.781 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 13:51:36.786 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 13:51:36.878 +08:00 [INF] Now listening on: http://localhost:5050
2025-08-06 13:51:36.885 +08:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-06 13:51:37.096 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-06 13:51:37.098 +08:00 [INF] Hosting environment: Development
2025-08-06 13:51:37.099 +08:00 [INF] Content root path: D:\Program\仓库\Warehource.Modules\Warehource.Source
2025-08-06 13:51:37.493 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/index.html - null null
2025-08-06 13:51:37.773 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/index.html - 200 null text/html;charset=utf-8 297.5657ms
2025-08-06 13:51:37.963 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_vs/browserLink - null null
2025-08-06 13:51:37.963 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - null null
2025-08-06 13:51:37.981 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 18.3412ms
2025-08-06 13:51:38.004 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_vs/browserLink - 200 null text/javascript; charset=UTF-8 41.1989ms
2025-08-06 13:51:38.047 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - null null
2025-08-06 13:51:38.073 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 26.2124ms
2025-08-06 13:51:38.124 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - null null
2025-08-06 13:51:38.135 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 11.0186ms
2025-08-06 13:51:38.354 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - null null
2025-08-06 13:51:38.361 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 6.7175ms
2025-08-06 13:51:38.880 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - null null
2025-08-06 13:51:38.905 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 25.3212ms
2025-08-06 13:51:39.241 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - null null
2025-08-06 13:51:39.259 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 17.9287ms
2025-08-06 13:52:07.823 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5050/wcstask/add-or-update-wcstask - application/json 320
2025-08-06 13:52:07.834 +08:00 [INF] CORS policy execution successful.
2025-08-06 13:52:07.855 +08:00 [WRN] Failed to determine the https port for redirect.
2025-08-06 13:52:07.927 +08:00 [INF] Executing endpoint 'HTTP: POST wcstask/add-or-update-wcstask'
2025-08-06 13:52:08.275 +08:00 [INF] Executed DbCommand (25ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Wcs.WcsTask] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__id_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-06 13:53:51.734 +08:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 50), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int32), @p4='?' (Size = 4000), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 50), @p10='?' (DbType = Guid), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32), @p13='?' (Size = 10), @p14='?' (Size = 10), @p15='?' (Size = 10), @p16='?' (Size = 10), @p17='?' (Size = 10), @p18='?' (Size = 10), @p19='?' (Size = 10), @p20='?' (Size = 10), @p21='?' (Size = 10), @p22='?' (Size = 10), @p23='?' (DbType = Guid), @p24='?' (DbType = DateTime2), @p25='?' (Size = 50), @p26='?' (DbType = Guid), @p27='?' (DbType = Boolean), @p28='?' (DbType = Boolean), @p29='?' (DbType = DateTime2), @p30='?' (Size = 4000), @p31='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Wcs.WcsTask] ([Id], [Container], [CreationTime], [CreatorSystemType], [Description], [IsDeleted], [LastModificationTime], [LastModifierUser], [RegionId], [TaskCode], [TaskExecuteStepId], [TaskStatus], [TaskType], [GetLocation_GetColumn], [GetLocation_GetDepth], [GetLocation_GetFloor], [GetLocation_GetRow], [GetLocation_GetTunnel], [PutLocation_PutColumn], [PutLocation_PutDepth], [PutLocation_PutFloor], [PutLocation_PutRow], [PutLocation_PutTunnel])
OUTPUT INSERTED.[SerialNumber], INSERTED.[Version]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
INSERT INTO [Wcs.TaskExecuteStep] ([Id], [CreationTime], [Description], [ExecuteNodePath], [IsDeleted], [IsSend], [LastModificationTime], [LastModifierUser], [PathNodeGroup])
OUTPUT INSERTED.[Version]
VALUES (@p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31);
2025-08-06 13:53:53.981 +08:00 [ERR] An exception occurred in the database while saving changes for context type 'Wcs.Infrastructure.Database.WCSDBContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): INSERT 语句与 FOREIGN KEY 约束"FK_Wcs.WcsTask_Wcs.TaskExecuteStep_TaskExecuteStepId"冲突。该冲突发生于数据库"Wcs.Source"，表"dbo.Wcs.TaskExecuteStep", column 'Id'。
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:f870be46-5b78-40ec-90a4-7abf8a6b77a6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): INSERT 语句与 FOREIGN KEY 约束"FK_Wcs.WcsTask_Wcs.TaskExecuteStep_TaskExecuteStepId"冲突。该冲突发生于数据库"Wcs.Source"，表"dbo.Wcs.TaskExecuteStep", column 'Id'。
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:f870be46-5b78-40ec-90a4-7abf8a6b77a6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-06 13:53:54.296 +08:00 [INF] Executed endpoint 'HTTP: POST wcstask/add-or-update-wcstask'
2025-08-06 13:53:54.408 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): INSERT 语句与 FOREIGN KEY 约束"FK_Wcs.WcsTask_Wcs.TaskExecuteStep_TaskExecuteStepId"冲突。该冲突发生于数据库"Wcs.Source"，表"dbo.Wcs.TaskExecuteStep", column 'Id'。
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:f870be46-5b78-40ec-90a4-7abf8a6b77a6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Common.Infrastructure.EF.BaseDbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) in D:\Program\仓库\Warehource.Modules\Common.Infrastructure\EF\BaseDbContext.cs:line 26
   at Wcs.Application.DBHandler.WcsTask.Insert.AddOrUpdateWcsTaskHandler.Handle(AddOrUpdateWcsTaskEvent request, CancellationToken cancellationToken) in D:\Program\仓库\Warehource.Modules\Wcs.Application\DBHandler\WcsTask\AddOrUpdate\AddOrUpdateWcsTaskHandler.cs:line 71
   at Common.Application.MediatR.Behaviors.ValidationPipelineBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\Program\仓库\Warehource.Modules\Common.Application\MediatR\Behaviors\ValidationPipelineBehavior.cs:line 20
   at Wcs.Presentation.WcsTask.AddOrUpdateWcsTask.<>c.<<MapEndpoint>b__0_0>d.MoveNext() in D:\Program\仓库\Warehource.Modules\Wcs.Presentation\WcsTask\AddOrUpdateWcsTask.cs:line 25
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.<ExecuteTaskOfT>g__ExecuteAwaited|133_0[T](Task`1 task, HttpContext httpContext, JsonTypeInfo`1 jsonTypeInfo)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.<>c__DisplayClass102_2.<<HandleRequestBodyAndCompileRequestDelegateForJson>b__2>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-06 13:53:54.575 +08:00 [ERR] HTTP POST /wcstask/add-or-update-wcstask responded 500 in 106713.8234 ms
2025-08-06 13:53:54.669 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5050/wcstask/add-or-update-wcstask - 500 null application/json; charset=utf-8 106845.978ms
2025-08-06 13:54:15.186 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5050/wcstask/add-or-update-wcstask - application/json 320
2025-08-06 13:54:15.196 +08:00 [INF] CORS policy execution successful.
2025-08-06 13:54:15.203 +08:00 [INF] Executing endpoint 'HTTP: POST wcstask/add-or-update-wcstask'
2025-08-06 13:54:15.222 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Wcs.WcsTask] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__id_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-06 13:54:18.478 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 50), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int32), @p4='?' (Size = 4000), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 50), @p10='?' (DbType = Guid), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32), @p13='?' (Size = 10), @p14='?' (Size = 10), @p15='?' (Size = 10), @p16='?' (Size = 10), @p17='?' (Size = 10), @p18='?' (Size = 10), @p19='?' (Size = 10), @p20='?' (Size = 10), @p21='?' (Size = 10), @p22='?' (Size = 10), @p23='?' (DbType = Guid), @p24='?' (DbType = DateTime2), @p25='?' (Size = 50), @p26='?' (DbType = Guid), @p27='?' (DbType = Boolean), @p28='?' (DbType = Boolean), @p29='?' (DbType = DateTime2), @p30='?' (Size = 4000), @p31='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Wcs.WcsTask] ([Id], [Container], [CreationTime], [CreatorSystemType], [Description], [IsDeleted], [LastModificationTime], [LastModifierUser], [RegionId], [TaskCode], [TaskExecuteStepId], [TaskStatus], [TaskType], [GetLocation_GetColumn], [GetLocation_GetDepth], [GetLocation_GetFloor], [GetLocation_GetRow], [GetLocation_GetTunnel], [PutLocation_PutColumn], [PutLocation_PutDepth], [PutLocation_PutFloor], [PutLocation_PutRow], [PutLocation_PutTunnel])
OUTPUT INSERTED.[SerialNumber], INSERTED.[Version]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
INSERT INTO [Wcs.TaskExecuteStep] ([Id], [CreationTime], [Description], [ExecuteNodePath], [IsDeleted], [IsSend], [LastModificationTime], [LastModifierUser], [PathNodeGroup])
OUTPUT INSERTED.[Version]
VALUES (@p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31);
2025-08-06 13:54:18.722 +08:00 [ERR] An exception occurred in the database while saving changes for context type 'Wcs.Infrastructure.Database.WCSDBContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): INSERT 语句与 FOREIGN KEY 约束"FK_Wcs.WcsTask_Wcs.TaskExecuteStep_TaskExecuteStepId"冲突。该冲突发生于数据库"Wcs.Source"，表"dbo.Wcs.TaskExecuteStep", column 'Id'。
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:f870be46-5b78-40ec-90a4-7abf8a6b77a6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): INSERT 语句与 FOREIGN KEY 约束"FK_Wcs.WcsTask_Wcs.TaskExecuteStep_TaskExecuteStepId"冲突。该冲突发生于数据库"Wcs.Source"，表"dbo.Wcs.TaskExecuteStep", column 'Id'。
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:f870be46-5b78-40ec-90a4-7abf8a6b77a6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-06 13:54:18.958 +08:00 [INF] Executed endpoint 'HTTP: POST wcstask/add-or-update-wcstask'
2025-08-06 13:54:19.073 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): INSERT 语句与 FOREIGN KEY 约束"FK_Wcs.WcsTask_Wcs.TaskExecuteStep_TaskExecuteStepId"冲突。该冲突发生于数据库"Wcs.Source"，表"dbo.Wcs.TaskExecuteStep", column 'Id'。
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:f870be46-5b78-40ec-90a4-7abf8a6b77a6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Common.Infrastructure.EF.BaseDbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) in D:\Program\仓库\Warehource.Modules\Common.Infrastructure\EF\BaseDbContext.cs:line 26
   at Wcs.Application.DBHandler.WcsTask.Insert.AddOrUpdateWcsTaskHandler.Handle(AddOrUpdateWcsTaskEvent request, CancellationToken cancellationToken) in D:\Program\仓库\Warehource.Modules\Wcs.Application\DBHandler\WcsTask\AddOrUpdate\AddOrUpdateWcsTaskHandler.cs:line 71
   at Common.Application.MediatR.Behaviors.ValidationPipelineBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\Program\仓库\Warehource.Modules\Common.Application\MediatR\Behaviors\ValidationPipelineBehavior.cs:line 20
   at Wcs.Presentation.WcsTask.AddOrUpdateWcsTask.<>c.<<MapEndpoint>b__0_0>d.MoveNext() in D:\Program\仓库\Warehource.Modules\Wcs.Presentation\WcsTask\AddOrUpdateWcsTask.cs:line 25
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.<ExecuteTaskOfT>g__ExecuteAwaited|133_0[T](Task`1 task, HttpContext httpContext, JsonTypeInfo`1 jsonTypeInfo)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.<>c__DisplayClass102_2.<<HandleRequestBodyAndCompileRequestDelegateForJson>b__2>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-06 13:58:06.089 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:58:06.143 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Wcs.__EFMigrationsHistory]');
2025-08-06 13:58:06.149 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:58:06.153 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Wcs.__EFMigrationsHistory]');
2025-08-06 13:58:06.164 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Wcs.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 13:58:06.176 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 13:58:06.203 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:58:06.207 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Identity.__EFMigrationsHistory]');
2025-08-06 13:58:06.211 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:58:06.214 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Identity.__EFMigrationsHistory]');
2025-08-06 13:58:06.219 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Identity.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 13:58:06.225 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 13:58:06.299 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:58:06.304 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Plc.__EFMigrationsHistory]');
2025-08-06 13:58:06.309 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 13:58:06.315 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Plc.__EFMigrationsHistory]');
2025-08-06 13:58:06.322 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Plc.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 13:58:06.334 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 13:58:06.649 +08:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[CreationTime], [w].[Description], [w].[IsDeleted], [w].[IsStart], [w].[JobType], [w].[LastModificationTime], [w].[LastModifierUser], [w].[Name], [w].[TimeOut], [w].[Timer]
FROM [Wcs.JobConfig] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-06 13:58:06.757 +08:00 [INF] User profile is available. Using 'C:\Users\吴\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-06 13:58:06.821 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 13:58:06.825 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 13:58:06.831 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 13:58:07.030 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 13:58:07.034 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 13:58:07.109 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 13:58:07.109 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 13:58:07.109 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 13:58:07.109 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_9bqoyynqz1igyjohbdq7jmtzyx"
2025-08-06 13:58:07.110 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 13:58:07.210 +08:00 [INF] Now listening on: http://localhost:5050
2025-08-06 13:58:07.217 +08:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-06 13:58:07.416 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-06 13:58:07.418 +08:00 [INF] Hosting environment: Development
2025-08-06 13:58:07.420 +08:00 [INF] Content root path: D:\Program\仓库\Warehource.Modules\Warehource.Source
2025-08-06 13:58:07.682 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/index.html - null null
2025-08-06 13:58:07.911 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/index.html - 200 null text/html;charset=utf-8 244.8924ms
2025-08-06 13:58:08.111 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - null null
2025-08-06 13:58:08.111 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_vs/browserLink - null null
2025-08-06 13:58:08.121 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 9.5212ms
2025-08-06 13:58:08.171 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_vs/browserLink - 200 null text/javascript; charset=UTF-8 59.7764ms
2025-08-06 13:58:08.225 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - null null
2025-08-06 13:58:08.279 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 54.7947ms
2025-08-06 13:58:19.542 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5050/wcstask/add-or-update-wcstask - application/json 320
2025-08-06 13:58:19.551 +08:00 [INF] CORS policy execution successful.
2025-08-06 13:58:19.577 +08:00 [WRN] Failed to determine the https port for redirect.
2025-08-06 13:58:19.657 +08:00 [INF] Executing endpoint 'HTTP: POST wcstask/add-or-update-wcstask'
2025-08-06 13:58:20.080 +08:00 [INF] Executed DbCommand (23ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Wcs.WcsTask] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__id_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-06 13:58:20.563 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 50), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int32), @p4='?' (Size = 4000), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 50), @p10='?' (DbType = Guid), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32), @p13='?' (Size = 10), @p14='?' (Size = 10), @p15='?' (Size = 10), @p16='?' (Size = 10), @p17='?' (Size = 10), @p18='?' (Size = 10), @p19='?' (Size = 10), @p20='?' (Size = 10), @p21='?' (Size = 10), @p22='?' (Size = 10), @p23='?' (DbType = Guid), @p24='?' (DbType = DateTime2), @p25='?' (Size = 50), @p26='?' (DbType = Guid), @p27='?' (DbType = Boolean), @p28='?' (DbType = Boolean), @p29='?' (DbType = DateTime2), @p30='?' (Size = 4000), @p31='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Wcs.WcsTask] ([Id], [Container], [CreationTime], [CreatorSystemType], [Description], [IsDeleted], [LastModificationTime], [LastModifierUser], [RegionId], [TaskCode], [TaskExecuteStepId], [TaskStatus], [TaskType], [GetLocation_GetColumn], [GetLocation_GetDepth], [GetLocation_GetFloor], [GetLocation_GetRow], [GetLocation_GetTunnel], [PutLocation_PutColumn], [PutLocation_PutDepth], [PutLocation_PutFloor], [PutLocation_PutRow], [PutLocation_PutTunnel])
OUTPUT INSERTED.[SerialNumber], INSERTED.[Version]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
INSERT INTO [Wcs.TaskExecuteStep] ([Id], [CreationTime], [Description], [ExecuteNodePath], [IsDeleted], [IsSend], [LastModificationTime], [LastModifierUser], [PathNodeGroup])
OUTPUT INSERTED.[Version]
VALUES (@p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31);
2025-08-06 13:58:20.989 +08:00 [ERR] An exception occurred in the database while saving changes for context type 'Wcs.Infrastructure.Database.WCSDBContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): INSERT 语句与 FOREIGN KEY 约束"FK_Wcs.WcsTask_Wcs.TaskExecuteStep_TaskExecuteStepId"冲突。该冲突发生于数据库"Wcs.Source"，表"dbo.Wcs.TaskExecuteStep", column 'Id'。
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:a7f4dffc-d2fb-433f-b123-7284c2b14aff
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): INSERT 语句与 FOREIGN KEY 约束"FK_Wcs.WcsTask_Wcs.TaskExecuteStep_TaskExecuteStepId"冲突。该冲突发生于数据库"Wcs.Source"，表"dbo.Wcs.TaskExecuteStep", column 'Id'。
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:a7f4dffc-d2fb-433f-b123-7284c2b14aff
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-06 13:58:21.459 +08:00 [INF] Executed endpoint 'HTTP: POST wcstask/add-or-update-wcstask'
2025-08-06 13:58:21.616 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): INSERT 语句与 FOREIGN KEY 约束"FK_Wcs.WcsTask_Wcs.TaskExecuteStep_TaskExecuteStepId"冲突。该冲突发生于数据库"Wcs.Source"，表"dbo.Wcs.TaskExecuteStep", column 'Id'。
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:a7f4dffc-d2fb-433f-b123-7284c2b14aff
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Common.Infrastructure.EF.BaseDbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) in D:\Program\仓库\Warehource.Modules\Common.Infrastructure\EF\BaseDbContext.cs:line 26
   at Wcs.Application.DBHandler.WcsTask.Insert.AddOrUpdateWcsTaskHandler.Handle(AddOrUpdateWcsTaskEvent request, CancellationToken cancellationToken) in D:\Program\仓库\Warehource.Modules\Wcs.Application\DBHandler\WcsTask\AddOrUpdate\AddOrUpdateWcsTaskHandler.cs:line 72
   at Common.Application.MediatR.Behaviors.ValidationPipelineBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\Program\仓库\Warehource.Modules\Common.Application\MediatR\Behaviors\ValidationPipelineBehavior.cs:line 20
   at Wcs.Presentation.WcsTask.AddOrUpdateWcsTask.<>c.<<MapEndpoint>b__0_0>d.MoveNext() in D:\Program\仓库\Warehource.Modules\Wcs.Presentation\WcsTask\AddOrUpdateWcsTask.cs:line 25
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.<ExecuteTaskOfT>g__ExecuteAwaited|133_0[T](Task`1 task, HttpContext httpContext, JsonTypeInfo`1 jsonTypeInfo)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.<>c__DisplayClass102_2.<<HandleRequestBodyAndCompileRequestDelegateForJson>b__2>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-06 13:58:21.777 +08:00 [ERR] HTTP POST /wcstask/add-or-update-wcstask responded 500 in 2194.6821 ms
2025-08-06 13:58:21.856 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5050/wcstask/add-or-update-wcstask - 500 null application/json; charset=utf-8 2314.0089ms
2025-08-06 14:02:25.143 +08:00 [INF] Executed DbCommand (293ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [Wcs.Source];
2025-08-06 14:03:04.160 +08:00 [INF] Executed DbCommand (93ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [Wcs.Source] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-08-06 14:03:04.236 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:03:04.349 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Wcs.__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK_Wcs.__EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-08-06 14:03:04.356 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:03:04.387 +08:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Wcs.__EFMigrationsHistory]');
2025-08-06 14:03:04.396 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Wcs.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 14:03:04.424 +08:00 [INF] Applying migration '20250806060215_InitialCreate'.
2025-08-06 14:03:04.522 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Wcs.JobConfig] (
    [Id] uniqueidentifier NOT NULL,
    [Name] nvarchar(50) NOT NULL,
    [Description] nvarchar(50) NULL,
    [JobType] nvarchar(50) NOT NULL,
    [TimeOut] int NOT NULL,
    [Timer] int NOT NULL,
    [IsStart] bit NOT NULL,
    [CreationTime] datetime2 NOT NULL,
    [LastModifierUser] nvarchar(max) NULL,
    [LastModificationTime] datetime2 NULL,
    [IsDeleted] bit NOT NULL,
    CONSTRAINT [PK_Wcs.JobConfig] PRIMARY KEY NONCLUSTERED ([Id])
);
2025-08-06 14:03:04.532 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Wcs.Region] (
    [Id] uniqueidentifier NOT NULL,
    [Code] nvarchar(20) NOT NULL,
    [Description] nvarchar(50) NULL,
    [CurrentNum] int NULL,
    [CreationTime] datetime2 NOT NULL,
    [LastModifierUser] nvarchar(max) NULL,
    [LastModificationTime] datetime2 NULL,
    [IsDeleted] bit NOT NULL,
    CONSTRAINT [PK_Wcs.Region] PRIMARY KEY NONCLUSTERED ([Id])
);
2025-08-06 14:03:04.543 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Wcs.TaskExecuteStep] (
    [Id] uniqueidentifier NOT NULL,
    [IsSend] bit NOT NULL,
    [Description] nvarchar(50) NULL,
    [PathNodeGroup] nvarchar(50) NULL,
    [ExecuteNodePath] uniqueidentifier NULL,
    [Version] rowversion NULL,
    [CreationTime] datetime2 NOT NULL,
    [LastModifierUser] nvarchar(max) NULL,
    [LastModificationTime] datetime2 NULL,
    [IsDeleted] bit NOT NULL,
    CONSTRAINT [PK_Wcs.TaskExecuteStep] PRIMARY KEY NONCLUSTERED ([Id])
);
2025-08-06 14:03:04.550 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ExecuteNodes] (
    [Id] uniqueidentifier NOT NULL,
    [PahtNodeGroup] nvarchar(max) NOT NULL,
    [CurrentDeviceType] int NOT NULL,
    [TaskType] int NOT NULL,
    [CurrentDeviceName] nvarchar(max) NOT NULL,
    [NextDeviceName] nvarchar(max) NULL,
    [RegionId] uniqueidentifier NULL,
    [CreationTime] datetime2 NOT NULL,
    [LastModifierUser] nvarchar(max) NULL,
    [LastModificationTime] datetime2 NULL,
    [IsDeleted] bit NOT NULL,
    CONSTRAINT [PK_ExecuteNodes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ExecuteNodes_Wcs.Region_RegionId] FOREIGN KEY ([RegionId]) REFERENCES [Wcs.Region] ([Id])
);
2025-08-06 14:03:04.560 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Wcs.Device] (
    [Id] uniqueidentifier NOT NULL,
    [DeviceType] int NOT NULL,
    [DeviceName] nvarchar(450) NOT NULL,
    [Config] nvarchar(max) NOT NULL,
    [Enable] bit NOT NULL,
    [RegionId] uniqueidentifier NOT NULL,
    [CreationTime] datetime2 NOT NULL,
    [LastModifierUser] nvarchar(max) NULL,
    [LastModificationTime] datetime2 NULL,
    [IsDeleted] bit NOT NULL,
    CONSTRAINT [PK_Wcs.Device] PRIMARY KEY NONCLUSTERED ([Id]),
    CONSTRAINT [FK_Wcs.Device_Wcs.Region_RegionId] FOREIGN KEY ([RegionId]) REFERENCES [Wcs.Region] ([Id]) ON DELETE CASCADE
);
2025-08-06 14:03:04.572 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Wcs.WcsTask] (
    [Id] uniqueidentifier NOT NULL,
    [TaskCode] nvarchar(50) NULL,
    [SerialNumber] int NOT NULL IDENTITY(4000, 1),
    [Container] nvarchar(50) NOT NULL,
    [TaskType] int NOT NULL,
    [TaskStatus] int NOT NULL,
    [CreatorSystemType] int NOT NULL,
    [Description] nvarchar(max) NULL,
    [GetLocation_GetTunnel] nvarchar(10) NULL,
    [GetLocation_GetFloor] nvarchar(10) NULL,
    [GetLocation_GetRow] nvarchar(10) NULL,
    [GetLocation_GetColumn] nvarchar(10) NULL,
    [GetLocation_GetDepth] nvarchar(10) NULL,
    [PutLocation_PutTunnel] nvarchar(10) NULL,
    [PutLocation_PutFloor] nvarchar(10) NULL,
    [PutLocation_PutRow] nvarchar(10) NULL,
    [PutLocation_PutColumn] nvarchar(10) NULL,
    [PutLocation_PutDepth] nvarchar(10) NULL,
    [RegionId] uniqueidentifier NULL,
    [TaskExecuteStepId] uniqueidentifier NOT NULL,
    [Version] rowversion NULL,
    [CreationTime] datetime2 NOT NULL,
    [LastModifierUser] nvarchar(max) NULL,
    [LastModificationTime] datetime2 NULL,
    [IsDeleted] bit NOT NULL,
    CONSTRAINT [PK_Wcs.WcsTask] PRIMARY KEY NONCLUSTERED ([Id]),
    CONSTRAINT [FK_Wcs.WcsTask_Wcs.TaskExecuteStep_TaskExecuteStepId] FOREIGN KEY ([TaskExecuteStepId]) REFERENCES [Wcs.TaskExecuteStep] ([Id]) ON DELETE CASCADE
);
2025-08-06 14:03:04.582 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ExecuteNodes_RegionId] ON [ExecuteNodes] ([RegionId]);
2025-08-06 14:03:04.595 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Wcs.Device_DeviceName] ON [Wcs.Device] ([DeviceName]);
2025-08-06 14:03:04.601 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Wcs.Device_RegionId] ON [Wcs.Device] ([RegionId]);
2025-08-06 14:03:04.605 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Wcs.JobConfig_Name] ON [Wcs.JobConfig] ([Name]);
2025-08-06 14:03:04.608 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Wcs.Region_Code] ON [Wcs.Region] ([Code]);
2025-08-06 14:03:04.612 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Wcs.WcsTask_SerialNumber] ON [Wcs.WcsTask] ([SerialNumber]);
2025-08-06 14:03:04.624 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Wcs.WcsTask_TaskCode] ON [Wcs.WcsTask] ([TaskCode]) WHERE [TaskCode] IS NOT NULL;
2025-08-06 14:03:04.629 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Wcs.WcsTask_TaskExecuteStepId] ON [Wcs.WcsTask] ([TaskExecuteStepId]);
2025-08-06 14:03:04.638 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [Wcs.__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250806060215_InitialCreate', N'8.0.0');
2025-08-06 14:03:04.738 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:03:04.742 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Identity.__EFMigrationsHistory]');
2025-08-06 14:03:04.745 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:03:04.753 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Identity.__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK_Identity.__EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-08-06 14:03:04.756 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:03:04.760 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Identity.__EFMigrationsHistory]');
2025-08-06 14:03:04.764 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Identity.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 14:03:04.768 +08:00 [INF] Applying migration '20250801013315_InitialCreate'.
2025-08-06 14:03:04.781 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Identity.Role] (
    [Id] uniqueidentifier NOT NULL,
    [RoleName] nvarchar(50) NOT NULL,
    [Description] nvarchar(max) NULL,
    [CreationTime] datetime2 NOT NULL,
    [LastModifierUser] nvarchar(max) NULL,
    [LastModificationTime] datetime2 NULL,
    [IsDeleted] bit NOT NULL,
    CONSTRAINT [PK_Identity.Role] PRIMARY KEY NONCLUSTERED ([Id])
);
2025-08-06 14:03:04.787 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Identity.User] (
    [Id] uniqueidentifier NOT NULL,
    [Name] nvarchar(max) NOT NULL,
    [Description] nvarchar(max) NULL,
    [Email] nvarchar(max) NULL,
    [Phone] nvarchar(max) NULL,
    [Username] nvarchar(50) NOT NULL,
    [Password] nvarchar(20) NOT NULL,
    [LockoutEnd] datetimeoffset NOT NULL,
    [RoleId] uniqueidentifier NOT NULL,
    [CreationTime] datetime2 NOT NULL,
    [LastModifierUser] nvarchar(max) NULL,
    [LastModificationTime] datetime2 NULL,
    [IsDeleted] bit NOT NULL,
    CONSTRAINT [PK_Identity.User] PRIMARY KEY NONCLUSTERED ([Id]),
    CONSTRAINT [FK_Identity.User_Identity.Role_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [Identity.Role] ([Id]) ON DELETE CASCADE
);
2025-08-06 14:03:04.793 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE NONCLUSTERED INDEX [IX_Identity.Role_RoleName] ON [Identity.Role] ([RoleName]);
2025-08-06 14:03:04.799 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Identity.User_RoleId] ON [Identity.User] ([RoleId]);
2025-08-06 14:03:04.807 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE NONCLUSTERED INDEX [IX_Identity.User_Username] ON [Identity.User] ([Username]);
2025-08-06 14:03:04.810 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [Identity.__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250801013315_InitialCreate', N'8.0.0');
2025-08-06 14:03:04.993 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:03:04.999 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Plc.__EFMigrationsHistory]');
2025-08-06 14:03:05.002 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:03:05.014 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Plc.__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK_Plc.__EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-08-06 14:03:05.020 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:03:05.026 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Plc.__EFMigrationsHistory]');
2025-08-06 14:03:05.031 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Plc.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 14:03:05.041 +08:00 [INF] Applying migration '20250804021810_InitialCreate'.
2025-08-06 14:03:05.056 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Plc.S7NetConfig] (
    [Id] uniqueidentifier NOT NULL,
    [S7Type] int NOT NULL,
    [Solt] smallint NOT NULL,
    [Rack] smallint NOT NULL,
    [ReadTimeOut] int NOT NULL,
    [WriteTimeOut] int NOT NULL,
    [IsUse] bit NOT NULL,
    [ReadHeart] nvarchar(20) NULL,
    [WriteHeart] nvarchar(20) NULL,
    [CreationTime] datetime2 NOT NULL,
    [LastModifierUser] nvarchar(max) NULL,
    [LastModificationTime] datetime2 NULL,
    [IsDeleted] bit NOT NULL,
    [Ip] nvarchar(max) NOT NULL,
    [Port] int NOT NULL,
    CONSTRAINT [PK_Plc.S7NetConfig] PRIMARY KEY NONCLUSTERED ([Id])
);
2025-08-06 14:03:05.063 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Plc.S7EntityItem] (
    [Id] uniqueidentifier NOT NULL,
    [Ip] nvarchar(20) NOT NULL,
    [S7DataType] int NOT NULL,
    [DBAddress] int NOT NULL,
    [DataOffset] int NOT NULL,
    [BitOffset] tinyint NULL,
    [S7BlockType] int NOT NULL,
    [Index] int NOT NULL,
    [Description] nvarchar(50) NULL,
    [Name] nvarchar(20) NOT NULL,
    [ArrtypeLength] tinyint NULL,
    [DeviceName] nvarchar(max) NOT NULL,
    [IsUse] bit NOT NULL,
    [NetGuid] uniqueidentifier NOT NULL,
    [CreationTime] datetime2 NOT NULL,
    [LastModifierUser] nvarchar(max) NULL,
    [LastModificationTime] datetime2 NULL,
    [IsDeleted] bit NOT NULL,
    CONSTRAINT [PK_Plc.S7EntityItem] PRIMARY KEY NONCLUSTERED ([Id]),
    CONSTRAINT [FK_Plc.S7EntityItem_Plc.S7NetConfig_NetGuid] FOREIGN KEY ([NetGuid]) REFERENCES [Plc.S7NetConfig] ([Id]) ON DELETE CASCADE
);
2025-08-06 14:03:05.068 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Plc.S7EntityItem_NetGuid] ON [Plc.S7EntityItem] ([NetGuid]);
2025-08-06 14:03:05.074 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [Plc.__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250804021810_InitialCreate', N'8.0.0');
2025-08-06 14:03:05.680 +08:00 [INF] Executed DbCommand (56ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[CreationTime], [w].[Description], [w].[IsDeleted], [w].[IsStart], [w].[JobType], [w].[LastModificationTime], [w].[LastModifierUser], [w].[Name], [w].[TimeOut], [w].[Timer]
FROM [Wcs.JobConfig] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-06 14:03:05.939 +08:00 [INF] User profile is available. Using 'C:\Users\吴\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-06 14:03:06.041 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 14:03:06.047 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 14:03:06.051 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 14:03:06.511 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 14:03:06.517 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 14:03:06.632 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 14:03:06.650 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 14:03:06.632 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 14:03:06.654 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_atjyyynqz1igy4yxbdq7jmzjrj"
2025-08-06 14:03:06.669 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 14:03:06.863 +08:00 [INF] Now listening on: http://localhost:5050
2025-08-06 14:03:06.877 +08:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-06 14:03:07.271 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-06 14:03:07.272 +08:00 [INF] Hosting environment: Development
2025-08-06 14:03:07.274 +08:00 [INF] Content root path: D:\Program\仓库\Warehource.Modules\Warehource.Source
2025-08-06 14:03:07.403 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/index.html - null null
2025-08-06 14:03:07.599 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/index.html - 200 null text/html;charset=utf-8 206.1224ms
2025-08-06 14:03:07.756 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - null null
2025-08-06 14:03:07.756 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_vs/browserLink - null null
2025-08-06 14:03:07.762 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 5.6232ms
2025-08-06 14:03:07.798 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_vs/browserLink - 200 null text/javascript; charset=UTF-8 41.898ms
2025-08-06 14:03:07.863 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - null null
2025-08-06 14:03:07.882 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 18.2884ms
2025-08-06 14:03:12.600 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5050/wcstask/add-or-update-wcstask - application/json 318
2025-08-06 14:03:12.608 +08:00 [INF] CORS policy execution successful.
2025-08-06 14:03:12.627 +08:00 [WRN] Failed to determine the https port for redirect.
2025-08-06 14:03:12.700 +08:00 [INF] Executing endpoint 'HTTP: POST wcstask/add-or-update-wcstask'
2025-08-06 14:03:13.229 +08:00 [INF] Executed DbCommand (99ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Wcs.WcsTask] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__id_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-06 14:03:13.454 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (Size = 50), @p9='?' (DbType = Guid), @p10='?' (Size = 50), @p11='?' (DbType = DateTime2), @p12='?' (DbType = Int32), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (DbType = DateTime2), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p18='?' (Size = 50), @p19='?' (DbType = Guid), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (Size = 10), @p23='?' (Size = 10), @p24='?' (Size = 10), @p25='?' (Size = 10), @p26='?' (Size = 10), @p27='?' (Size = 10), @p28='?' (Size = 10), @p29='?' (Size = 10), @p30='?' (Size = 10), @p31='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Wcs.TaskExecuteStep] ([Id], [CreationTime], [Description], [ExecuteNodePath], [IsDeleted], [IsSend], [LastModificationTime], [LastModifierUser], [PathNodeGroup])
OUTPUT INSERTED.[Version]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
INSERT INTO [Wcs.WcsTask] ([Id], [Container], [CreationTime], [CreatorSystemType], [Description], [IsDeleted], [LastModificationTime], [LastModifierUser], [RegionId], [TaskCode], [TaskExecuteStepId], [TaskStatus], [TaskType], [GetLocation_GetColumn], [GetLocation_GetDepth], [GetLocation_GetFloor], [GetLocation_GetRow], [GetLocation_GetTunnel], [PutLocation_PutColumn], [PutLocation_PutDepth], [PutLocation_PutFloor], [PutLocation_PutRow], [PutLocation_PutTunnel])
OUTPUT INSERTED.[SerialNumber], INSERTED.[Version]
VALUES (@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31);
2025-08-06 14:03:13.498 +08:00 [INF] Executed endpoint 'HTTP: POST wcstask/add-or-update-wcstask'
2025-08-06 14:03:13.502 +08:00 [INF] HTTP POST /wcstask/add-or-update-wcstask responded 200 in 871.3649 ms
2025-08-06 14:03:13.743 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5050/wcstask/add-or-update-wcstask - 200 null application/json; charset=utf-8 1142.9936ms
2025-08-06 14:05:17.568 +08:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:05:17.633 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Wcs.__EFMigrationsHistory]');
2025-08-06 14:05:17.646 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:05:17.651 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Wcs.__EFMigrationsHistory]');
2025-08-06 14:05:17.670 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Wcs.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 14:05:17.691 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 14:05:17.717 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:05:17.726 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Identity.__EFMigrationsHistory]');
2025-08-06 14:05:17.730 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:05:17.741 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Identity.__EFMigrationsHistory]');
2025-08-06 14:05:17.749 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Identity.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 14:05:17.759 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 14:05:17.859 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:05:17.864 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Plc.__EFMigrationsHistory]');
2025-08-06 14:05:17.868 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:05:17.873 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Plc.__EFMigrationsHistory]');
2025-08-06 14:05:17.883 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Plc.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 14:05:17.902 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 14:05:18.255 +08:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[CreationTime], [w].[Description], [w].[IsDeleted], [w].[IsStart], [w].[JobType], [w].[LastModificationTime], [w].[LastModifierUser], [w].[Name], [w].[TimeOut], [w].[Timer]
FROM [Wcs.JobConfig] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-06 14:05:18.360 +08:00 [INF] User profile is available. Using 'C:\Users\吴\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-06 14:05:18.424 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 14:05:18.430 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 14:05:18.437 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 14:05:18.664 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 14:05:18.669 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 14:05:18.773 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_sb3oyynqz1igbjnpbdq7jm3an1"
2025-08-06 14:05:18.773 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 14:05:18.773 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 14:05:18.773 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 14:05:18.775 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 14:05:18.882 +08:00 [INF] Now listening on: http://localhost:5050
2025-08-06 14:05:18.895 +08:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-06 14:05:19.105 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-06 14:05:19.107 +08:00 [INF] Hosting environment: Development
2025-08-06 14:05:19.109 +08:00 [INF] Content root path: D:\Program\仓库\Warehource.Modules\Warehource.Source
2025-08-06 14:05:19.377 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/index.html - null null
2025-08-06 14:05:19.591 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/index.html - 200 null text/html;charset=utf-8 226.0832ms
2025-08-06 14:05:19.653 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - null null
2025-08-06 14:05:19.660 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 7.1463ms
2025-08-06 14:05:20.165 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_vs/browserLink - null null
2025-08-06 14:05:20.219 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_vs/browserLink - 200 null text/javascript; charset=UTF-8 53.7855ms
2025-08-06 14:05:20.552 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - null null
2025-08-06 14:05:20.576 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 24.4029ms
2025-08-06 14:06:40.067 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5050/wcstask/add-or-update-wcstask - application/json 318
2025-08-06 14:06:40.081 +08:00 [INF] CORS policy execution successful.
2025-08-06 14:06:40.102 +08:00 [WRN] Failed to determine the https port for redirect.
2025-08-06 14:06:40.178 +08:00 [INF] Executing endpoint 'HTTP: POST wcstask/add-or-update-wcstask'
2025-08-06 14:06:40.702 +08:00 [INF] Executed DbCommand (26ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Wcs.WcsTask] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__id_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-06 14:06:41.129 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (Size = 50), @p9='?' (DbType = Guid), @p10='?' (Size = 50), @p11='?' (DbType = DateTime2), @p12='?' (DbType = Int32), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (DbType = DateTime2), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p18='?' (Size = 50), @p19='?' (DbType = Guid), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (Size = 10), @p23='?' (Size = 10), @p24='?' (Size = 10), @p25='?' (Size = 10), @p26='?' (Size = 10), @p27='?' (Size = 10), @p28='?' (Size = 10), @p29='?' (Size = 10), @p30='?' (Size = 10), @p31='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Wcs.TaskExecuteStep] ([Id], [CreationTime], [Description], [ExecuteNodePath], [IsDeleted], [IsSend], [LastModificationTime], [LastModifierUser], [PathNodeGroup])
OUTPUT INSERTED.[Version]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
INSERT INTO [Wcs.WcsTask] ([Id], [Container], [CreationTime], [CreatorSystemType], [Description], [IsDeleted], [LastModificationTime], [LastModifierUser], [RegionId], [TaskCode], [TaskExecuteStepId], [TaskStatus], [TaskType], [GetLocation_GetColumn], [GetLocation_GetDepth], [GetLocation_GetFloor], [GetLocation_GetRow], [GetLocation_GetTunnel], [PutLocation_PutColumn], [PutLocation_PutDepth], [PutLocation_PutFloor], [PutLocation_PutRow], [PutLocation_PutTunnel])
OUTPUT INSERTED.[SerialNumber], INSERTED.[Version]
VALUES (@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31);
2025-08-06 14:06:41.684 +08:00 [ERR] An exception occurred in the database while saving changes for context type 'Wcs.Infrastructure.Database.WCSDBContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): 不能在具有唯一索引“IX_Wcs.WcsTask_TaskCode”的对象“dbo.Wcs.WcsTask”中插入重复键的行。重复键值为 (string)。
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4b6b2b7c-4c2e-424a-a6cf-5bb9ec06594f
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): 不能在具有唯一索引“IX_Wcs.WcsTask_TaskCode”的对象“dbo.Wcs.WcsTask”中插入重复键的行。重复键值为 (string)。
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4b6b2b7c-4c2e-424a-a6cf-5bb9ec06594f
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-08-06 14:06:42.237 +08:00 [INF] Executed endpoint 'HTTP: POST wcstask/add-or-update-wcstask'
2025-08-06 14:06:42.425 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): 不能在具有唯一索引“IX_Wcs.WcsTask_TaskCode”的对象“dbo.Wcs.WcsTask”中插入重复键的行。重复键值为 (string)。
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4b6b2b7c-4c2e-424a-a6cf-5bb9ec06594f
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Common.Infrastructure.EF.BaseDbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) in D:\Program\仓库\Warehource.Modules\Common.Infrastructure\EF\BaseDbContext.cs:line 26
   at Wcs.Application.DBHandler.WcsTask.Insert.AddOrUpdateWcsTaskHandler.Handle(AddOrUpdateWcsTaskEvent request, CancellationToken cancellationToken) in D:\Program\仓库\Warehource.Modules\Wcs.Application\DBHandler\WcsTask\AddOrUpdate\AddOrUpdateWcsTaskHandler.cs:line 71
   at Common.Application.MediatR.Behaviors.ValidationPipelineBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in D:\Program\仓库\Warehource.Modules\Common.Application\MediatR\Behaviors\ValidationPipelineBehavior.cs:line 20
   at Wcs.Presentation.WcsTask.AddOrUpdateWcsTask.<>c.<<MapEndpoint>b__0_0>d.MoveNext() in D:\Program\仓库\Warehource.Modules\Wcs.Presentation\WcsTask\AddOrUpdateWcsTask.cs:line 25
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.<ExecuteTaskOfT>g__ExecuteAwaited|133_0[T](Task`1 task, HttpContext httpContext, JsonTypeInfo`1 jsonTypeInfo)
   at Microsoft.AspNetCore.Http.RequestDelegateFactory.<>c__DisplayClass102_2.<<HandleRequestBodyAndCompileRequestDelegateForJson>b__2>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-08-06 14:06:42.736 +08:00 [ERR] HTTP POST /wcstask/add-or-update-wcstask responded 500 in 2629.2312 ms
2025-08-06 14:06:42.870 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5050/wcstask/add-or-update-wcstask - 500 null application/json; charset=utf-8 2802.2726ms
2025-08-06 14:07:09.564 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5050/wcstask/add-or-update-wcstask - application/json 320
2025-08-06 14:07:09.589 +08:00 [INF] CORS policy execution successful.
2025-08-06 14:07:09.596 +08:00 [INF] Executing endpoint 'HTTP: POST wcstask/add-or-update-wcstask'
2025-08-06 14:07:09.627 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Wcs.WcsTask] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__id_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-06 14:07:09.664 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (Size = 50), @p9='?' (DbType = Guid), @p10='?' (Size = 50), @p11='?' (DbType = DateTime2), @p12='?' (DbType = Int32), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (DbType = DateTime2), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p18='?' (Size = 50), @p19='?' (DbType = Guid), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (Size = 10), @p23='?' (Size = 10), @p24='?' (Size = 10), @p25='?' (Size = 10), @p26='?' (Size = 10), @p27='?' (Size = 10), @p28='?' (Size = 10), @p29='?' (Size = 10), @p30='?' (Size = 10), @p31='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Wcs.TaskExecuteStep] ([Id], [CreationTime], [Description], [ExecuteNodePath], [IsDeleted], [IsSend], [LastModificationTime], [LastModifierUser], [PathNodeGroup])
OUTPUT INSERTED.[Version]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
INSERT INTO [Wcs.WcsTask] ([Id], [Container], [CreationTime], [CreatorSystemType], [Description], [IsDeleted], [LastModificationTime], [LastModifierUser], [RegionId], [TaskCode], [TaskExecuteStepId], [TaskStatus], [TaskType], [GetLocation_GetColumn], [GetLocation_GetDepth], [GetLocation_GetFloor], [GetLocation_GetRow], [GetLocation_GetTunnel], [PutLocation_PutColumn], [PutLocation_PutDepth], [PutLocation_PutFloor], [PutLocation_PutRow], [PutLocation_PutTunnel])
OUTPUT INSERTED.[SerialNumber], INSERTED.[Version]
VALUES (@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31);
2025-08-06 14:07:09.746 +08:00 [INF] Executed endpoint 'HTTP: POST wcstask/add-or-update-wcstask'
2025-08-06 14:07:09.750 +08:00 [INF] HTTP POST /wcstask/add-or-update-wcstask responded 200 in 156.2378 ms
2025-08-06 14:07:09.888 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5050/wcstask/add-or-update-wcstask - 200 null application/json; charset=utf-8 324.1113ms
2025-08-06 14:14:29.781 +08:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5050/wcstask/delete-wcstask/{serialNumber}?request=4000 - null null
2025-08-06 14:14:29.793 +08:00 [INF] CORS policy execution successful.
2025-08-06 14:14:29.811 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-08-06 14:14:29.837 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-06 14:14:29.839 +08:00 [INF] HTTP DELETE /wcstask/delete-wcstask/{serialNumber} responded 401 in 44.8104 ms
2025-08-06 14:14:29.916 +08:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5050/wcstask/delete-wcstask/{serialNumber}?request=4000 - 401 0 null 143.502ms
2025-08-06 14:14:43.348 +08:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5050/wcstask/delete-wcstask/{serialNumber}?request=4000 - null null
2025-08-06 14:14:43.367 +08:00 [INF] CORS policy execution successful.
2025-08-06 14:14:43.451 +08:00 [INF] Executing endpoint 'HTTP: DELETE wcstask/delete-wcstask/{serialNumber}'
2025-08-06 14:14:43.865 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__serialNumber_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Wcs.WcsTask] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[SerialNumber] = @__serialNumber_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-06 14:14:43.955 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__serialNumber_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [w].[Id], [w].[Container], [w].[CreationTime], [w].[CreatorSystemType], [w].[Description], [w].[IsDeleted], [w].[LastModificationTime], [w].[LastModifierUser], [w].[RegionId], [w].[SerialNumber], [w].[TaskCode], [w].[TaskExecuteStepId], [w].[TaskStatus], [w].[TaskType], [w].[Version], [w].[GetLocation_GetColumn], [w].[GetLocation_GetDepth], [w].[GetLocation_GetFloor], [w].[GetLocation_GetRow], [w].[GetLocation_GetTunnel], [w].[PutLocation_PutColumn], [w].[PutLocation_PutDepth], [w].[PutLocation_PutFloor], [w].[PutLocation_PutRow], [w].[PutLocation_PutTunnel]
FROM [Wcs.WcsTask] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[SerialNumber] = @__serialNumber_0
2025-08-06 14:14:44.012 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p2='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Wcs.WcsTask] SET [IsDeleted] = @p0
OUTPUT INSERTED.[Version]
WHERE [Id] = @p1 AND [Version] = @p2;
2025-08-06 14:14:44.022 +08:00 [INF] Executed endpoint 'HTTP: DELETE wcstask/delete-wcstask/{serialNumber}'
2025-08-06 14:14:44.024 +08:00 [INF] HTTP DELETE /wcstask/delete-wcstask/{serialNumber} responded 200 in 655.3236 ms
2025-08-06 14:14:44.127 +08:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5050/wcstask/delete-wcstask/{serialNumber}?request=4000 - 200 null application/json; charset=utf-8 780.033ms
2025-08-06 14:14:55.752 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/wcstask/get-wcstask/{serialNumber}?request=4000 - null null
2025-08-06 14:14:55.761 +08:00 [INF] Executing endpoint 'HTTP: GET wcstask/get-wcstask/{serialNumber}'
2025-08-06 14:14:56.230 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_SerialNumber_0='?' (DbType = Int32), @__request_TaskStatus_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[Container], [w].[CreationTime], [w].[CreatorSystemType], [w].[Description], [w].[IsDeleted], [w].[LastModificationTime], [w].[LastModifierUser], [w].[RegionId], [w].[SerialNumber], [w].[TaskCode], [w].[TaskExecuteStepId], [w].[TaskStatus], [w].[TaskType], [w].[Version], [w].[GetLocation_GetColumn], [w].[GetLocation_GetDepth], [w].[GetLocation_GetFloor], [w].[GetLocation_GetRow], [w].[GetLocation_GetTunnel], [w].[PutLocation_PutColumn], [w].[PutLocation_PutDepth], [w].[PutLocation_PutFloor], [w].[PutLocation_PutRow], [w].[PutLocation_PutTunnel]
FROM [Wcs.WcsTask] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[SerialNumber] = @__request_SerialNumber_0 AND [w].[TaskStatus] = @__request_TaskStatus_1
2025-08-06 14:14:56.259 +08:00 [INF] Executed endpoint 'HTTP: GET wcstask/get-wcstask/{serialNumber}'
2025-08-06 14:14:56.265 +08:00 [INF] HTTP GET /wcstask/get-wcstask/{serialNumber} responded 200 in 508.5554 ms
2025-08-06 14:14:56.328 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/wcstask/get-wcstask/{serialNumber}?request=4000 - 200 null application/json; charset=utf-8 575.5169ms
2025-08-06 14:15:04.997 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/wcstask/get-wcstask/{serialNumber}?request=4001 - null null
2025-08-06 14:15:05.008 +08:00 [INF] Executing endpoint 'HTTP: GET wcstask/get-wcstask/{serialNumber}'
2025-08-06 14:15:05.017 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_SerialNumber_0='?' (DbType = Int32), @__request_TaskStatus_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[Container], [w].[CreationTime], [w].[CreatorSystemType], [w].[Description], [w].[IsDeleted], [w].[LastModificationTime], [w].[LastModifierUser], [w].[RegionId], [w].[SerialNumber], [w].[TaskCode], [w].[TaskExecuteStepId], [w].[TaskStatus], [w].[TaskType], [w].[Version], [w].[GetLocation_GetColumn], [w].[GetLocation_GetDepth], [w].[GetLocation_GetFloor], [w].[GetLocation_GetRow], [w].[GetLocation_GetTunnel], [w].[PutLocation_PutColumn], [w].[PutLocation_PutDepth], [w].[PutLocation_PutFloor], [w].[PutLocation_PutRow], [w].[PutLocation_PutTunnel]
FROM [Wcs.WcsTask] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[SerialNumber] = @__request_SerialNumber_0 AND [w].[TaskStatus] = @__request_TaskStatus_1
2025-08-06 14:15:05.022 +08:00 [INF] Executed endpoint 'HTTP: GET wcstask/get-wcstask/{serialNumber}'
2025-08-06 14:15:05.024 +08:00 [INF] HTTP GET /wcstask/get-wcstask/{serialNumber} responded 200 in 16.4150 ms
2025-08-06 14:15:05.059 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/wcstask/get-wcstask/{serialNumber}?request=4001 - 200 null application/json; charset=utf-8 63.0191ms
2025-08-06 14:15:07.351 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/wcstask/get-wcstask/{serialNumber}?request=4001 - null null
2025-08-06 14:15:07.358 +08:00 [INF] Executing endpoint 'HTTP: GET wcstask/get-wcstask/{serialNumber}'
2025-08-06 14:15:07.370 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_SerialNumber_0='?' (DbType = Int32), @__request_TaskStatus_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[Container], [w].[CreationTime], [w].[CreatorSystemType], [w].[Description], [w].[IsDeleted], [w].[LastModificationTime], [w].[LastModifierUser], [w].[RegionId], [w].[SerialNumber], [w].[TaskCode], [w].[TaskExecuteStepId], [w].[TaskStatus], [w].[TaskType], [w].[Version], [w].[GetLocation_GetColumn], [w].[GetLocation_GetDepth], [w].[GetLocation_GetFloor], [w].[GetLocation_GetRow], [w].[GetLocation_GetTunnel], [w].[PutLocation_PutColumn], [w].[PutLocation_PutDepth], [w].[PutLocation_PutFloor], [w].[PutLocation_PutRow], [w].[PutLocation_PutTunnel]
FROM [Wcs.WcsTask] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[SerialNumber] = @__request_SerialNumber_0 AND [w].[TaskStatus] = @__request_TaskStatus_1
2025-08-06 14:15:07.376 +08:00 [INF] Executed endpoint 'HTTP: GET wcstask/get-wcstask/{serialNumber}'
2025-08-06 14:15:07.378 +08:00 [INF] HTTP GET /wcstask/get-wcstask/{serialNumber} responded 200 in 20.1739 ms
2025-08-06 14:15:07.426 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/wcstask/get-wcstask/{serialNumber}?request=4001 - 200 null application/json; charset=utf-8 75.1819ms
2025-08-06 14:15:50.168 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/wcstask/get-wcstask/{serialNumber}?request=4001 - null null
2025-08-06 14:15:50.194 +08:00 [INF] Executing endpoint 'HTTP: GET wcstask/get-wcstask/{serialNumber}'
2025-08-06 14:15:59.788 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/index.html - null null
2025-08-06 14:15:59.926 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/index.html - 200 null text/html;charset=utf-8 137.7905ms
2025-08-06 14:15:59.982 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - null null
2025-08-06 14:15:59.992 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/_vs/browserLink - null null
2025-08-06 14:16:00.018 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_framework/aspnetcore-browser-refresh.js - 200 13770 application/javascript; charset=utf-8 35.748ms
2025-08-06 14:16:00.290 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/_vs/browserLink - 200 null text/javascript; charset=UTF-8 297.6131ms
2025-08-06 14:16:00.352 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - null null
2025-08-06 14:16:00.363 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_SerialNumber_0='?' (DbType = Int32), @__request_TaskStatus_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[Container], [w].[CreationTime], [w].[CreatorSystemType], [w].[Description], [w].[IsDeleted], [w].[LastModificationTime], [w].[LastModifierUser], [w].[RegionId], [w].[SerialNumber], [w].[TaskCode], [w].[TaskExecuteStepId], [w].[TaskStatus], [w].[TaskType], [w].[Version], [w].[GetLocation_GetColumn], [w].[GetLocation_GetDepth], [w].[GetLocation_GetFloor], [w].[GetLocation_GetRow], [w].[GetLocation_GetTunnel], [w].[PutLocation_PutColumn], [w].[PutLocation_PutDepth], [w].[PutLocation_PutFloor], [w].[PutLocation_PutRow], [w].[PutLocation_PutTunnel]
FROM [Wcs.WcsTask] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[SerialNumber] = @__request_SerialNumber_0 AND [w].[TaskStatus] = @__request_TaskStatus_1
2025-08-06 14:16:07.451 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 7098.546ms
2025-08-06 14:16:07.482 +08:00 [INF] Executed endpoint 'HTTP: GET wcstask/get-wcstask/{serialNumber}'
2025-08-06 14:16:07.506 +08:00 [INF] HTTP GET /wcstask/get-wcstask/{serialNumber} responded 200 in 17313.0347 ms
2025-08-06 14:16:07.535 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/wcstask/get-wcstask/{serialNumber}?request=4001 - 499 null application/json; charset=utf-8 17367.2233ms
2025-08-06 14:16:27.021 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5050/wcstask/add-or-update-wcstask - application/json 321
2025-08-06 14:16:27.032 +08:00 [INF] CORS policy execution successful.
2025-08-06 14:16:27.044 +08:00 [INF] Executing endpoint 'HTTP: POST wcstask/add-or-update-wcstask'
2025-08-06 14:16:27.054 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Wcs.WcsTask] AS [w]
        WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[Id] = @__id_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-08-06 14:16:27.066 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime2), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (Size = 50), @p9='?' (DbType = Guid), @p10='?' (Size = 50), @p11='?' (DbType = DateTime2), @p12='?' (DbType = Int32), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (DbType = DateTime2), @p16='?' (Size = 4000), @p17='?' (DbType = Guid), @p18='?' (Size = 50), @p19='?' (DbType = Guid), @p20='?' (DbType = Int32), @p21='?' (DbType = Int32), @p22='?' (Size = 10), @p23='?' (Size = 10), @p24='?' (Size = 10), @p25='?' (Size = 10), @p26='?' (Size = 10), @p27='?' (Size = 10), @p28='?' (Size = 10), @p29='?' (Size = 10), @p30='?' (Size = 10), @p31='?' (Size = 10)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Wcs.TaskExecuteStep] ([Id], [CreationTime], [Description], [ExecuteNodePath], [IsDeleted], [IsSend], [LastModificationTime], [LastModifierUser], [PathNodeGroup])
OUTPUT INSERTED.[Version]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
INSERT INTO [Wcs.WcsTask] ([Id], [Container], [CreationTime], [CreatorSystemType], [Description], [IsDeleted], [LastModificationTime], [LastModifierUser], [RegionId], [TaskCode], [TaskExecuteStepId], [TaskStatus], [TaskType], [GetLocation_GetColumn], [GetLocation_GetDepth], [GetLocation_GetFloor], [GetLocation_GetRow], [GetLocation_GetTunnel], [PutLocation_PutColumn], [PutLocation_PutDepth], [PutLocation_PutFloor], [PutLocation_PutRow], [PutLocation_PutTunnel])
OUTPUT INSERTED.[SerialNumber], INSERTED.[Version]
VALUES (@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31);
2025-08-06 14:16:27.077 +08:00 [INF] Executed endpoint 'HTTP: POST wcstask/add-or-update-wcstask'
2025-08-06 14:16:27.080 +08:00 [INF] HTTP POST /wcstask/add-or-update-wcstask responded 200 in 36.5862 ms
2025-08-06 14:16:27.158 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5050/wcstask/add-or-update-wcstask - 200 null application/json; charset=utf-8 137.0493ms
2025-08-06 14:16:39.090 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/wcstask/get-wcstask/{serialNumber}?request=4002 - null null
2025-08-06 14:16:39.117 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-08-06 14:16:39.122 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-06 14:16:39.126 +08:00 [INF] HTTP GET /wcstask/get-wcstask/{serialNumber} responded 401 in 9.2737 ms
2025-08-06 14:16:39.176 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/wcstask/get-wcstask/{serialNumber}?request=4002 - 401 0 null 87.2681ms
2025-08-06 14:16:49.874 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/wcstask/get-wcstask/{serialNumber}?request=4002 - null null
2025-08-06 14:16:49.880 +08:00 [INF] Executing endpoint 'HTTP: GET wcstask/get-wcstask/{serialNumber}'
2025-08-06 14:16:51.401 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_SerialNumber_0='?' (DbType = Int32), @__request_TaskStatus_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[Container], [w].[CreationTime], [w].[CreatorSystemType], [w].[Description], [w].[IsDeleted], [w].[LastModificationTime], [w].[LastModifierUser], [w].[RegionId], [w].[SerialNumber], [w].[TaskCode], [w].[TaskExecuteStepId], [w].[TaskStatus], [w].[TaskType], [w].[Version], [w].[GetLocation_GetColumn], [w].[GetLocation_GetDepth], [w].[GetLocation_GetFloor], [w].[GetLocation_GetRow], [w].[GetLocation_GetTunnel], [w].[PutLocation_PutColumn], [w].[PutLocation_PutDepth], [w].[PutLocation_PutFloor], [w].[PutLocation_PutRow], [w].[PutLocation_PutTunnel]
FROM [Wcs.WcsTask] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit) AND [w].[SerialNumber] = @__request_SerialNumber_0 AND [w].[TaskStatus] = @__request_TaskStatus_1
2025-08-06 14:16:51.420 +08:00 [INF] Executed endpoint 'HTTP: GET wcstask/get-wcstask/{serialNumber}'
2025-08-06 14:16:51.422 +08:00 [INF] HTTP GET /wcstask/get-wcstask/{serialNumber} responded 200 in 1543.0920 ms
2025-08-06 14:16:51.445 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/wcstask/get-wcstask/{serialNumber}?request=4002 - 200 null application/json; charset=utf-8 1571.4211ms
2025-08-06 14:32:25.661 +08:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:32:25.716 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Wcs.__EFMigrationsHistory]');
2025-08-06 14:32:25.722 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:32:25.726 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Wcs.__EFMigrationsHistory]');
2025-08-06 14:32:25.736 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Wcs.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 14:32:25.750 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 14:32:25.784 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:32:25.788 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Identity.__EFMigrationsHistory]');
2025-08-06 14:32:25.790 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:32:25.796 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Identity.__EFMigrationsHistory]');
2025-08-06 14:32:25.801 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Identity.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 14:32:25.803 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 14:32:25.893 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:32:25.896 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Plc.__EFMigrationsHistory]');
2025-08-06 14:32:25.898 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:32:25.900 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Plc.__EFMigrationsHistory]');
2025-08-06 14:32:25.906 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Plc.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 14:32:25.908 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 14:32:26.184 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[CreationTime], [w].[Description], [w].[IsDeleted], [w].[IsStart], [w].[JobType], [w].[LastModificationTime], [w].[LastModifierUser], [w].[Name], [w].[TimeOut], [w].[Timer]
FROM [Wcs.JobConfig] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-06 14:32:26.228 +08:00 [INF] User profile is available. Using 'C:\Users\吴\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-06 14:32:26.405 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 14:32:26.412 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 14:32:26.416 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 14:32:26.509 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 14:32:26.513 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 14:32:26.543 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 14:32:26.543 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 14:32:26.543 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 14:32:26.543 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_pb6oyynqz1igyk5ebdq7jcanr4"
2025-08-06 14:32:26.547 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 14:32:26.574 +08:00 [INF] Now listening on: http://localhost:5050
2025-08-06 14:32:26.575 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-06 14:32:26.576 +08:00 [INF] Hosting environment: Development
2025-08-06 14:32:26.577 +08:00 [INF] Content root path: D:\Program\仓库\Warehource.Modules\Warehource.Source
2025-08-06 14:32:27.380 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/index.html - null null
2025-08-06 14:32:27.643 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/index.html - 200 null text/html;charset=utf-8 263.7921ms
2025-08-06 14:32:27.971 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - null null
2025-08-06 14:32:27.986 +08:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-06 14:32:28.127 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 155.8366ms
2025-08-06 14:33:17.434 +08:00 [INF] Application is shutting down...
2025-08-06 14:33:17.446 +08:00 [DBG] Stopping bus instances: IBus
2025-08-06 14:33:17.450 +08:00 [DBG] Stopping bus: "loopback://localhost/"
2025-08-06 14:33:17.455 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 14:33:17.457 +08:00 [DBG] Consumer Stopping: "loopback://localhost/WcsIntegrationEvent" (Stop Receive Transport)
2025-08-06 14:33:17.463 +08:00 [DBG] Endpoint Completed: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 14:33:17.472 +08:00 [DBG] Consumer Completed: "loopback://localhost/WcsIntegrationEvent": 0 received, 0 concurrent
2025-08-06 14:33:17.475 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 14:33:17.475 +08:00 [DBG] Consumer Stopping: "loopback://localhost/S7ReadPlcDataBlockEvent" (Stop Receive Transport)
2025-08-06 14:33:17.477 +08:00 [DBG] Endpoint Completed: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 14:33:17.477 +08:00 [DBG] Consumer Completed: "loopback://localhost/S7ReadPlcDataBlockEvent": 0 received, 0 concurrent
2025-08-06 14:33:17.478 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 14:33:17.479 +08:00 [DBG] Consumer Stopping: "loopback://localhost/S7WritePlcDataBlockEvent" (Stop Receive Transport)
2025-08-06 14:33:17.480 +08:00 [DBG] Endpoint Completed: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 14:33:17.480 +08:00 [DBG] Consumer Completed: "loopback://localhost/S7WritePlcDataBlockEvent": 0 received, 0 concurrent
2025-08-06 14:33:17.482 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/_WarehourceSource_bus_pb6oyynqz1igyk5ebdq7jcanr4"
2025-08-06 14:33:17.483 +08:00 [DBG] Consumer Stopping: "loopback://localhost/_WarehourceSource_bus_pb6oyynqz1igyk5ebdq7jcanr4" (Stop Receive Transport)
2025-08-06 14:33:17.484 +08:00 [DBG] Endpoint Completed: "loopback://localhost/_WarehourceSource_bus_pb6oyynqz1igyk5ebdq7jcanr4"
2025-08-06 14:33:17.484 +08:00 [DBG] Consumer Completed: "loopback://localhost/_WarehourceSource_bus_pb6oyynqz1igyk5ebdq7jcanr4": 0 received, 0 concurrent
2025-08-06 14:33:17.495 +08:00 [INF] Bus stopped: "loopback://localhost/"
2025-08-06 14:51:03.391 +08:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:51:03.452 +08:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Wcs.__EFMigrationsHistory]');
2025-08-06 14:51:03.459 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:51:03.463 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Wcs.__EFMigrationsHistory]');
2025-08-06 14:51:03.475 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Wcs.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 14:51:03.495 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 14:51:03.544 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:51:03.547 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Identity.__EFMigrationsHistory]');
2025-08-06 14:51:03.550 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:51:03.553 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Identity.__EFMigrationsHistory]');
2025-08-06 14:51:03.559 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Identity.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 14:51:03.562 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 14:51:03.659 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:51:03.663 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Plc.__EFMigrationsHistory]');
2025-08-06 14:51:03.667 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:51:03.670 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Plc.__EFMigrationsHistory]');
2025-08-06 14:51:03.676 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Plc.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 14:51:03.679 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 14:51:03.990 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[CreationTime], [w].[Description], [w].[IsDeleted], [w].[IsStart], [w].[JobType], [w].[LastModificationTime], [w].[LastModifierUser], [w].[Name], [w].[TimeOut], [w].[Timer]
FROM [Wcs.JobConfig] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-06 14:51:04.038 +08:00 [INF] User profile is available. Using 'C:\Users\吴\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-06 14:51:04.196 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 14:51:04.201 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 14:51:04.205 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 14:51:04.291 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 14:51:04.295 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 14:51:04.326 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 14:51:04.326 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_htwoyynqz1igyh3wbdq7jpchg5"
2025-08-06 14:51:04.326 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 14:51:04.326 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 14:51:04.334 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 14:51:04.362 +08:00 [INF] Now listening on: http://localhost:5050
2025-08-06 14:51:04.363 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-06 14:51:04.363 +08:00 [INF] Hosting environment: Development
2025-08-06 14:51:04.364 +08:00 [INF] Content root path: D:\Program\仓库\Warehource.Modules\Warehource.Source
2025-08-06 14:51:04.559 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/index.html - null null
2025-08-06 14:51:04.840 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/index.html - 200 null text/html;charset=utf-8 283.3489ms
2025-08-06 14:51:05.045 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - null null
2025-08-06 14:51:05.055 +08:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-06 14:51:05.192 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 147.0307ms
2025-08-06 14:52:07.890 +08:00 [INF] Application is shutting down...
2025-08-06 14:52:07.915 +08:00 [DBG] Stopping bus instances: IBus
2025-08-06 14:52:07.919 +08:00 [DBG] Stopping bus: "loopback://localhost/"
2025-08-06 14:52:07.925 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 14:52:07.926 +08:00 [DBG] Consumer Stopping: "loopback://localhost/WcsIntegrationEvent" (Stop Receive Transport)
2025-08-06 14:52:07.935 +08:00 [DBG] Endpoint Completed: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 14:52:07.949 +08:00 [DBG] Consumer Completed: "loopback://localhost/WcsIntegrationEvent": 0 received, 0 concurrent
2025-08-06 14:52:07.952 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 14:52:07.954 +08:00 [DBG] Consumer Stopping: "loopback://localhost/S7ReadPlcDataBlockEvent" (Stop Receive Transport)
2025-08-06 14:52:07.955 +08:00 [DBG] Endpoint Completed: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 14:52:07.956 +08:00 [DBG] Consumer Completed: "loopback://localhost/S7ReadPlcDataBlockEvent": 0 received, 0 concurrent
2025-08-06 14:52:07.957 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 14:52:07.958 +08:00 [DBG] Consumer Stopping: "loopback://localhost/S7WritePlcDataBlockEvent" (Stop Receive Transport)
2025-08-06 14:52:07.959 +08:00 [DBG] Endpoint Completed: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 14:52:07.960 +08:00 [DBG] Consumer Completed: "loopback://localhost/S7WritePlcDataBlockEvent": 0 received, 0 concurrent
2025-08-06 14:52:07.962 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/_WarehourceSource_bus_htwoyynqz1igyh3wbdq7jpchg5"
2025-08-06 14:52:07.963 +08:00 [DBG] Consumer Stopping: "loopback://localhost/_WarehourceSource_bus_htwoyynqz1igyh3wbdq7jpchg5" (Stop Receive Transport)
2025-08-06 14:52:07.964 +08:00 [DBG] Endpoint Completed: "loopback://localhost/_WarehourceSource_bus_htwoyynqz1igyh3wbdq7jpchg5"
2025-08-06 14:52:07.965 +08:00 [DBG] Consumer Completed: "loopback://localhost/_WarehourceSource_bus_htwoyynqz1igyh3wbdq7jpchg5": 0 received, 0 concurrent
2025-08-06 14:52:07.978 +08:00 [INF] Bus stopped: "loopback://localhost/"
2025-08-06 14:54:45.171 +08:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:54:45.235 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Wcs.__EFMigrationsHistory]');
2025-08-06 14:54:45.238 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:54:45.242 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Wcs.__EFMigrationsHistory]');
2025-08-06 14:54:45.253 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Wcs.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 14:54:45.268 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 14:54:45.302 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:54:45.305 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Identity.__EFMigrationsHistory]');
2025-08-06 14:54:45.309 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:54:45.314 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Identity.__EFMigrationsHistory]');
2025-08-06 14:54:45.328 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Identity.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 14:54:45.331 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 14:54:45.444 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:54:45.448 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Plc.__EFMigrationsHistory]');
2025-08-06 14:54:45.452 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-08-06 14:54:45.457 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[Plc.__EFMigrationsHistory]');
2025-08-06 14:54:45.464 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [Plc.__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-08-06 14:54:45.468 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-08-06 14:54:45.860 +08:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[CreationTime], [w].[Description], [w].[IsDeleted], [w].[IsStart], [w].[JobType], [w].[LastModificationTime], [w].[LastModifierUser], [w].[Name], [w].[TimeOut], [w].[Timer]
FROM [Wcs.JobConfig] AS [w]
WHERE [w].[IsDeleted] = CAST(0 AS bit)
2025-08-06 14:54:45.920 +08:00 [INF] User profile is available. Using 'C:\Users\吴\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-08-06 14:54:46.087 +08:00 [INF] Configured endpoint WcsIntegrationEvent, Consumer: Wcs.Application.Custom.WcsCustomEventConsumer<Wcs.CustomEvents.WcsIntegrationEvent>
2025-08-06 14:54:46.093 +08:00 [INF] Configured endpoint S7ReadPlcDataBlockEvent, Consumer: Plc.Application.Custom.ReadPlcEventConsumer<Plc.CustomEvents.S7ReadPlcDataBlockEvent>
2025-08-06 14:54:46.097 +08:00 [INF] Configured endpoint S7WritePlcDataBlockEvent, Consumer: Plc.Application.Custom.WritePlcEventConsumer<Plc.CustomEvents.S7WritePlcDataBlockEvent>
2025-08-06 14:54:46.187 +08:00 [DBG] Starting bus instances: IBus
2025-08-06 14:54:46.191 +08:00 [DBG] Starting bus: "loopback://localhost/"
2025-08-06 14:54:46.220 +08:00 [DBG] Endpoint Ready: "loopback://localhost/_WarehourceSource_bus_wbuyyynqz1igyfuobdq7jptby7"
2025-08-06 14:54:46.220 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 14:54:46.220 +08:00 [DBG] Endpoint Ready: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 14:54:46.220 +08:00 [DBG] Endpoint Ready: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 14:54:46.223 +08:00 [INF] Bus started: "loopback://localhost/"
2025-08-06 14:54:46.248 +08:00 [INF] Now listening on: http://localhost:5050
2025-08-06 14:54:46.249 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-06 14:54:46.250 +08:00 [INF] Hosting environment: Development
2025-08-06 14:54:46.250 +08:00 [INF] Content root path: D:\Program\仓库\Warehource.Modules\Warehource.Source
2025-08-06 14:54:46.289 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/index.html - null null
2025-08-06 14:54:46.543 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/index.html - 200 null text/html;charset=utf-8 254.6941ms
2025-08-06 14:54:47.420 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - null null
2025-08-06 14:54:47.430 +08:00 [INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
2025-08-06 14:54:47.611 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5050/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 191.3251ms
2025-08-06 14:55:21.309 +08:00 [INF] Application is shutting down...
2025-08-06 14:55:21.326 +08:00 [DBG] Stopping bus instances: IBus
2025-08-06 14:55:21.329 +08:00 [DBG] Stopping bus: "loopback://localhost/"
2025-08-06 14:55:21.335 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 14:55:21.336 +08:00 [DBG] Consumer Stopping: "loopback://localhost/WcsIntegrationEvent" (Stop Receive Transport)
2025-08-06 14:55:21.342 +08:00 [DBG] Endpoint Completed: "loopback://localhost/WcsIntegrationEvent"
2025-08-06 14:55:21.351 +08:00 [DBG] Consumer Completed: "loopback://localhost/WcsIntegrationEvent": 0 received, 0 concurrent
2025-08-06 14:55:21.355 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 14:55:21.356 +08:00 [DBG] Consumer Stopping: "loopback://localhost/S7ReadPlcDataBlockEvent" (Stop Receive Transport)
2025-08-06 14:55:21.357 +08:00 [DBG] Endpoint Completed: "loopback://localhost/S7ReadPlcDataBlockEvent"
2025-08-06 14:55:21.358 +08:00 [DBG] Consumer Completed: "loopback://localhost/S7ReadPlcDataBlockEvent": 0 received, 0 concurrent
2025-08-06 14:55:21.358 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 14:55:21.359 +08:00 [DBG] Consumer Stopping: "loopback://localhost/S7WritePlcDataBlockEvent" (Stop Receive Transport)
2025-08-06 14:55:21.360 +08:00 [DBG] Endpoint Completed: "loopback://localhost/S7WritePlcDataBlockEvent"
2025-08-06 14:55:21.360 +08:00 [DBG] Consumer Completed: "loopback://localhost/S7WritePlcDataBlockEvent": 0 received, 0 concurrent
2025-08-06 14:55:21.362 +08:00 [DBG] Endpoint Stopping: "loopback://localhost/_WarehourceSource_bus_wbuyyynqz1igyfuobdq7jptby7"
2025-08-06 14:55:21.362 +08:00 [DBG] Consumer Stopping: "loopback://localhost/_WarehourceSource_bus_wbuyyynqz1igyfuobdq7jptby7" (Stop Receive Transport)
2025-08-06 14:55:21.363 +08:00 [DBG] Endpoint Completed: "loopback://localhost/_WarehourceSource_bus_wbuyyynqz1igyfuobdq7jptby7"
2025-08-06 14:55:21.364 +08:00 [DBG] Consumer Completed: "loopback://localhost/_WarehourceSource_bus_wbuyyynqz1igyfuobdq7jptby7": 0 received, 0 concurrent
2025-08-06 14:55:21.375 +08:00 [INF] Bus stopped: "loopback://localhost/"
